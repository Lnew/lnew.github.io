[{"title":"PandasÂ§ÑÁêÜcsvÊï∞ÊçÆÂÖ•Â∫ì‰∫å","url":"/tech-notes/pandas-1563334142.html","content":"\n#### python ÁéØÂ¢É-Anaconda 5.2.0\n#### ÁõÆÂΩïÁªìÊûÑ\n- sh201001d\n    - 20100104\n        - 600000_20100104.csv\n    - 20100105\n        - 600000_20100105.csv\n    - 20100106\n        - 600000_20100106.csv\n        \n\n````\n# -*- coding: utf-8 -*-\nimport os\n\nimport pandas as pd\n\nfrom sqlalchemy import create_engine\n\n#ÊòæÁ§∫ÊâÄÊúâÂàó\n#pd.set_option('display.max_columns', None)\n#ÊòæÁ§∫ÊâÄÊúâË°å\n#pd.set_option('display.max_rows', None)\npd.set_option('display.float_format',lambda x : '%.2f' % x)\n\nfile_dir = \"D:\\\\BaiduNetdiskDownload\\\\2008-2018\\\\tick2010d\\\\sh201001d\"\nprefix = 'sh'\n# Êï∞ÊçÆÂ∫ì\nengine = create_engine('mysql+pymysql://root:@localhost:3306/gp_minute?charset=utf8&autocommit=true',echo=True)\n# Ëé∑ÂèñÁõÆÂΩï‰∏ãÊâÄÊúâÊñá‰ª∂Âêç\ndef file_name(file_dir):\n    file_list= [([]) for i in range(2)]\n    for root,dirs,files in os.walk(file_dir):\n        if files:\n            file_list[0].append(root)\n            file_list[1].append(files)\n    return file_list\n    \nfiles = file_name(file_dir)\n#file = 'sh600000.csv'\nfor index in range(0,len(files[0])):\n    for file in files[1][index]:\n        table_name = prefix+file.split('_')[0]\n        raw = pd.read_csv('%s\\\\%s'%(files[0][index],file),names=['Êó∂Èó¥','Êàê‰∫§Á¨îÊï∞','Êàê‰∫§È¢ù','Êàê‰∫§Èáè','ÊñπÂêë'],encoding='GBK', skiprows=1,usecols=[2,4,5,6,7],header=None)\n        raw['Êó∂Èó¥'] = pd.to_datetime(raw['Êó∂Èó¥']).dt.strftime('%Y%m%d%H%M')\n        raw['Êàê‰∫§Èáè'] = raw['Êàê‰∫§Èáè']*100\n        #print(raw.head())\n        # Ëé∑ÂèñÂàÜÁªÑÊó∂Èó¥\n        result = raw.groupby(raw['Êó∂Èó¥']).size().reset_index().drop(columns=[0])\n        result.columns = ['s_datemin']\n        # ËÆ°ÁÆó‰ª∑Ê†ºÂπ≥ÂùáÂÄº--ÂéªÊéâÊàê‰∫§Èáè‰∏∫Èõ∂ÁöÑË°å\n        s_price = raw.loc[raw['Êàê‰∫§Èáè']!=0]\n        s_price = (s_price['Êàê‰∫§È¢ù'].groupby(s_price['Êó∂Èó¥']).mean()/(s_price['Êàê‰∫§Èáè']).groupby(s_price['Êó∂Èó¥']).mean()).reset_index(name='ÂùáÊàê‰∫§È¢ù')\n        s_price.columns = ['s_datemin','s_price']\n        #print(s_price[:5])\n        # ÂàÜÂâ≤--B\n        b_result = raw.loc[raw['ÊñπÂêë']=='B']\n        b_result = (b_result[['Êàê‰∫§È¢ù','Êàê‰∫§Èáè','Êàê‰∫§Á¨îÊï∞']].groupby(b_result['Êó∂Èó¥']).sum()).reset_index()\n        #print(b_result[:5])\n        b_result.columns = ['s_datemin','s_bvalue','s_bshou','s_bci']\n        # ÂàÜÂâ≤--S\n        s_result = raw.loc[raw['ÊñπÂêë']=='S']\n        s_result = (s_result[['Êàê‰∫§È¢ù','Êàê‰∫§Èáè','Êàê‰∫§Á¨îÊï∞']].groupby(s_result['Êó∂Èó¥']).sum()).reset_index()\n        #print(s_result[:5])\n        s_result.columns = ['s_datemin','s_svalue','s_sshou','s_sci']\n        # ÂàÜÂâ≤--Z\n        z_result = raw.loc[~raw['ÊñπÂêë'].isin(['B','S'])]\n        z_result = (z_result[['Êàê‰∫§È¢ù','Êàê‰∫§Èáè','Êàê‰∫§Á¨îÊï∞']].groupby(z_result['Êó∂Èó¥']).sum()).reset_index()\n        #print(z_result[:5])\n        z_result.columns = ['s_datemin','s_zvalue','s_zshou','s_zci']\n        #ÂêàÂπ∂Êï∞ÊçÆ\n        info = pd.merge(result,s_price,on='s_datemin',how='left')\n        info = pd.merge(info,b_result,on='s_datemin',how='left')\n        info = pd.merge(info,s_result,on='s_datemin',how='left')\n        info = pd.merge(info,z_result,on='s_datemin',how='left')\n        info.fillna(0,inplace=True)\n        info.ix[info['s_price'].isin(['inf']),'s_price']=0\n        info['s_price'] = info['s_price'].round(2)\n        # ÂàõÂª∫Êï∞ÊçÆÂ∫ì\n        #### Ê£ÄÊµãÊï∞ÊçÆÂ∫ìÊòØÂê¶Â≠òÂú®\n        #table_name = file[:-4]\n        sql = 'SELECT table_name FROM information_schema.TABLES WHERE table_name = \"%s\"'%(table_name)\n        df = pd.read_sql_query(sql, engine)\n        if df.empty:\n            sql = '''\n            CREATE TABLE `%s` (\n              `s_id` int(11) NOT NULL AUTO_INCREMENT COMMENT '‰∏ªÈîÆËá™Â¢û',\n              `s_datemin` bigint(20) NULL COMMENT 'ÂàÜÈíü 201901010930 ÂîØ‰∏Ä',\n              `s_price` float(8,2) NULL COMMENT '‰ª∑Ê†ºÔºåÊú¨ÂàÜÈíü‰ª∑Ê†ºÂπ≥ÂùáÂÄº',\n              `s_bvalue` bigint(20) NULL DEFAULT '0' COMMENT 'Êú¨ÂàÜÈíü‰π∞ÂÖ•ÈáëÈ¢ùÔºåÂçï‰ΩçÂÖÉ',\n              `s_bshou` int(11) NULL DEFAULT '0' COMMENT 'Êú¨ÂàÜ‰π∞ÂÖ•ËÇ°Á•®Êï∞ Âçï‰ΩçËÇ°',\n              `s_bci` int(11) NULL DEFAULT '0' COMMENT 'Êú¨ÂàÜÈíü ‰π∞ÂÖ•‰∫§ÊòìÊ¨°Êï∞',\n              `s_svalue` bigint(20) NULL DEFAULT '0' COMMENT 'Êú¨ÂàÜÈíü ÂçñÂú∫‰ª∑ÂÄº Âçï‰ΩçÂÖÉ',\n              `s_sshou` int(11) NULL DEFAULT '0' COMMENT 'Êú¨ÂàÜÈíüÂçñÂá∫ ËÇ°Á•®Êï∞',\n              `s_sci` int(11) NULL DEFAULT '0' COMMENT 'Êú¨ÂàÜÂçñÂá∫‰∫§ÊòìÊ¨°Êï∞',\n              `s_zvalue` bigint(20) NULL DEFAULT '0' COMMENT 'Êú¨ÂàÜÈíü ‰∏≠ÊÄßÊàê‰∫§ÈáëÈ¢ù Âçï‰ΩçÂÖÉ',\n              `s_zshou` int(11) NULL DEFAULT '0' COMMENT 'Êú¨ÂàÜÈíü‰∏≠ÊÄß ËÇ°Êï∞',\n              `s_zci` int(11) NULL DEFAULT '0' COMMENT 'Êú¨ÂàÜÈíü ‰∏≠ÊÄß‰∫§ÊòìÊ¨°Êï∞',\n               PRIMARY KEY (`s_id`),\n               UNIQUE KEY `s_datem` (`s_datemin`)\n            ) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COMMENT='ËÇ°Á•®ÂéÜÂè≤ÊØèÂàÜÈíü‰∫§ÊòìÊ¨°Âèä‰∫§ÊòìÈáè' AUTO_INCREMENT=1 ;\n            '''%(table_name)\n            engine.execute(sql)\n        #else:\n            #sql = 'alter table `%s` modify column `s_bvalue` bigint(20),modify column `s_svalue` bigint(20),modify column `s_zvalue` bigint(20);'%(table_name)\n            #engine.execute(sql)\n        pd.io.sql.to_sql(info,table_name,con=engine,if_exists='append', index=False, chunksize=10000)\n        ## Âà†Èô§Â∑≤ÊâßË°åÊñá‰ª∂\n        os.remove('%s\\\\%s'%(files[0][index],file))\n````\n","tags":["Python"],"categories":["ÈöèÁ¨î"]},{"title":"ÂàùÁî®PandasÊìç‰ΩúËÆ∞ÂΩï","url":"/tech-notes/pandas-1562901077.html","content":"#### python ÁéØÂ¢É-Anaconda 5.2.0\n\n#### ÁõÆÂΩïÁªìÊûÑ\n- sz2008tick3\n    - sh600000.csv\n    - sh600001.csv\n    - sh600002.csv\n\n\n````\n# -*- coding: utf-8 -*-\nimport os\n\nimport pandas as pd\n\nfrom sqlalchemy import create_engine\n\n#ÊòæÁ§∫ÊâÄÊúâÂàó\n#pd.set_option('display.max_columns', None)\n#ÊòæÁ§∫ÊâÄÊúâË°å\n#pd.set_option('display.max_rows', None)\npd.set_option('display.float_format',lambda x : '%.2f' % x)\n\nfile_dir = \"D:\\\\BaiduNetdiskDownload\\\\2008-2018\\\\tick2008y\\\\sz2008tick3\"\n# Êï∞ÊçÆÂ∫ì\nengine = create_engine('mysql+pymysql://root:@localhost:3306/gp_minute?charset=utf8&autocommit=true',echo=True)\n# Ëé∑ÂèñÁõÆÂΩï‰∏ãÊâÄÊúâÊñá‰ª∂Âêç\ndef file_name(file_dir):\n    for root,dirs,files in os.walk(file_dir):\n        return files\n\nfiles = file_name(file_dir)\nfor file in files:\n    # ËØªÂèñcsvÊï∞ÊçÆ\n    raw = pd.read_csv('%s\\\\%s'%(file_dir,file),names=['Êó∂Èó¥','Êàê‰∫§Á¨îÊï∞','Êàê‰∫§È¢ù','Êàê‰∫§Èáè','ÊñπÂêë'],encoding='GBK', skiprows=1,usecols=[2,4,5,6,7],header=None)\n    # Ê†ºÂºèÂåñÊó∂Èó¥‰∏∫ÈúÄË¶ÅÊ†ºÂºè\n    raw['Êó∂Èó¥'] = pd.to_datetime(raw['Êó∂Èó¥']).dt.strftime('%Y%m%d%H%M')\n    # ‰øÆÊîπÂçï‰Ωç\n    raw['Êàê‰∫§Èáè'] = raw['Êàê‰∫§Èáè']*100\n    #print(raw.head())\n    # Ëé∑ÂèñÂàÜÁªÑÊó∂Èó¥\n    result = raw.groupby(raw['Êó∂Èó¥']).size().reset_index().drop(columns=[0])\n    result.columns = ['s_datemin']\n    # ËÆ°ÁÆó‰ª∑Ê†ºÂπ≥ÂùáÂÄº--ÂéªÊéâÊàê‰∫§Èáè‰∏∫Èõ∂ÁöÑË°å\n    s_price = raw.loc[raw['Êàê‰∫§Èáè']!=0]\n    s_price = (s_price['Êàê‰∫§È¢ù'].groupby(s_price['Êó∂Èó¥']).mean()/(s_price['Êàê‰∫§Èáè']).groupby(s_price['Êó∂Èó¥']).mean()).reset_index(name='ÂùáÊàê‰∫§È¢ù')\n    s_price.columns = ['s_datemin','s_price']\n    #print(s_price[:5])\n    # ÂàÜÂâ≤--B\n    b_result = raw.loc[raw['ÊñπÂêë']=='B']\n    b_result = (b_result[['Êàê‰∫§È¢ù','Êàê‰∫§Èáè','Êàê‰∫§Á¨îÊï∞']].groupby(b_result['Êó∂Èó¥']).sum()).reset_index()\n    #print(b_result[:5])\n    b_result.columns = ['s_datemin','s_bvalue','s_bshou','s_bci']\n    # ÂàÜÂâ≤--S\n    s_result = raw.loc[raw['ÊñπÂêë']=='S']\n    s_result = (s_result[['Êàê‰∫§È¢ù','Êàê‰∫§Èáè','Êàê‰∫§Á¨îÊï∞']].groupby(s_result['Êó∂Èó¥']).sum()).reset_index()\n    #print(s_result[:5])\n    s_result.columns = ['s_datemin','s_svalue','s_sshou','s_sci']\n    # ÂàÜÂâ≤--Z\n    z_result = raw.loc[~raw['ÊñπÂêë'].isin(['B','S'])]\n    z_result = (z_result[['Êàê‰∫§È¢ù','Êàê‰∫§Èáè','Êàê‰∫§Á¨îÊï∞']].groupby(z_result['Êó∂Èó¥']).sum()).reset_index()\n    #print(z_result[:5])\n    z_result.columns = ['s_datemin','s_zvalue','s_zshou','s_zci']\n    #ÂêàÂπ∂Êï∞ÊçÆ\n    info = pd.merge(result,s_price,on='s_datemin',how='left')\n    info = pd.merge(info,b_result,on='s_datemin',how='left')\n    info = pd.merge(info,s_result,on='s_datemin',how='left')\n    info = pd.merge(info,z_result,on='s_datemin',how='left')\n    info.fillna(0,inplace=True)\n    info.ix[info['s_price'].isin(['inf']),'s_price']=0\n    info['s_price'] = info['s_price'].round(2)\n    # ÂàõÂª∫Êï∞ÊçÆÂ∫ì\n    #### Ê£ÄÊµãÊï∞ÊçÆÂ∫ìÊòØÂê¶Â≠òÂú®\n    table_name = file[:-4]\n    sql = 'SELECT table_name FROM information_schema.TABLES WHERE table_name = \"%s\"'%(table_name)\n    df = pd.read_sql_query(sql, engine)\n    if df.empty:\n        sql = '''\n        CREATE TABLE `%s` (\n          `s_id` int(11) NOT NULL AUTO_INCREMENT COMMENT '‰∏ªÈîÆËá™Â¢û',\n          `s_datemin` bigint(20) NULL COMMENT 'ÂàÜÈíü 201901010930 ÂîØ‰∏Ä',\n          `s_price` float(8,2) NULL COMMENT '‰ª∑Ê†ºÔºåÊú¨ÂàÜÈíü‰ª∑Ê†ºÂπ≥ÂùáÂÄº',\n          `s_bvalue` bigint(20) NULL DEFAULT '0' COMMENT 'Êú¨ÂàÜÈíü‰π∞ÂÖ•ÈáëÈ¢ùÔºåÂçï‰ΩçÂÖÉ',\n          `s_bshou` int(11) NULL DEFAULT '0' COMMENT 'Êú¨ÂàÜ‰π∞ÂÖ•ËÇ°Á•®Êï∞ Âçï‰ΩçËÇ°',\n          `s_bci` int(11) NULL DEFAULT '0' COMMENT 'Êú¨ÂàÜÈíü ‰π∞ÂÖ•‰∫§ÊòìÊ¨°Êï∞',\n          `s_svalue` bigint(20) NULL DEFAULT '0' COMMENT 'Êú¨ÂàÜÈíü ÂçñÂú∫‰ª∑ÂÄº Âçï‰ΩçÂÖÉ',\n          `s_sshou` int(11) NULL DEFAULT '0' COMMENT 'Êú¨ÂàÜÈíüÂçñÂá∫ ËÇ°Á•®Êï∞',\n          `s_sci` int(11) NULL DEFAULT '0' COMMENT 'Êú¨ÂàÜÂçñÂá∫‰∫§ÊòìÊ¨°Êï∞',\n          `s_zvalue` bigint(20) NULL DEFAULT '0' COMMENT 'Êú¨ÂàÜÈíü ‰∏≠ÊÄßÊàê‰∫§ÈáëÈ¢ù Âçï‰ΩçÂÖÉ',\n          `s_zshou` int(11) NULL DEFAULT '0' COMMENT 'Êú¨ÂàÜÈíü‰∏≠ÊÄß ËÇ°Êï∞',\n          `s_zci` int(11) NULL DEFAULT '0' COMMENT 'Êú¨ÂàÜÈíü ‰∏≠ÊÄß‰∫§ÊòìÊ¨°Êï∞',\n           PRIMARY KEY (`s_id`),\n           UNIQUE KEY `s_datem` (`s_datemin`)\n        ) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COMMENT='ËÇ°Á•®ÂéÜÂè≤ÊØèÂàÜÈíü‰∫§ÊòìÊ¨°Âèä‰∫§ÊòìÈáè' AUTO_INCREMENT=1 ;\n        '''%(table_name)\n        engine.execute(sql)\n    else:\n        sql = 'alter table `%s` modify column `s_bvalue` bigint(20),modify column `s_svalue` bigint(20),modify column `s_zvalue` bigint(20);'%(table_name)\n        engine.execute(sql)\n    pd.io.sql.to_sql(info,table_name,con=engine,if_exists='append', index=False, chunksize=10000)\n    ## Âà†Èô§Â∑≤ÊâßË°åÊñá‰ª∂\n    os.remove('%s\\\\%s'%(file_dir,file))\n````\n","tags":["Python"],"categories":["ÈöèÁ¨î"]},{"title":"Mysql‰∏ª‰ªéÂêåÊ≠•Á¨¨‰∫åÁØá","url":"/tech-notes/mysql-1562661148.html","content":"#### ÊàëÈÅáÂà∞ÁöÑÈóÆÈ¢ò\n- Á¨¨‰∏ÄÊ¨°ÈÖçÂ•ΩÂêéÔºåÂ∞ëÂ§á‰ªΩ‰∫Ü‰∏Ä‰∏™Ë°®ÔºåÁÑ∂ÂêéÊä•Èîô‰∫Ü\n    - ÊàëÁöÑÊñπÊ≥ïÊó∂Êñ∞Âª∫Ë°®ÔºåÁªìÊûúÊúâ‰∫ÜÊõ¥Â§öÈîôËØØ\n    - Áî±‰∫éË°®Â§™Â§öÔºåÊúÄÂêéÈáçÂÅö‰∫ÜÔºÅ\n- Á¨¨‰∫åÊ¨°Âê∏ÂèñÊïôËÆ≠ÔºåÁî®ÈÇ£Âá†‰∏™Ë°®ÔºåÂêåÊ≠•ÈÇ£Âá†‰∏™ÔºåÂú®‰ªéÊï∞ÊçÆÂ∫ìÈÖçÁΩÆÔºöreplicate_wild_do_table=\n    - ËøôÈáåÈÅáÂà∞Â§ßÂùëÔºåÁúãÁΩë‰∏äËØ¥ÊòØÁî®ÈÇ£Âá†‰∏™Ë°®ÔºåË°®Âêç‰πãÈó¥ÈÄóÂè∑ÈöîÂºÄ\n    - ÈÖçÂ•ΩÂêéÔºå‰∏ÄÂàáÊ≠£Â∏∏ÔºåËøá‰∫Ü‰∏Ä‰ºöÂèëÁé∞ËôΩÁÑ∂ËøêË°åÊ≠£Â∏∏Ôºå‰ΩÜÂ∞±ÊòØË°®Ê≤°ÊúâÂèòÂåñ\n    - Âú®ÁΩë‰∏äÊâæ‰∫ÜÂ•ΩÂ§öÊñπÊ≥ïÔºåÈÉΩ‰∏çÁÆ°Áî®\n    - Êä±ÁùÄÊ≠ªÁöÑÂøÉÁêÜÔºåÊàëÊääÈÖçÁΩÆÈáçÂÜô‰∫Ü‰∏ãÔºå‰∏çÂÜçÊòØreplicate_wild_do_table=db.t1,db.t2ËøôÁßç\n    - ÊîπÊàê‰∫Ü replicate_wild_do_table=db.t1  Êç¢Ë°å replicate_wild_do_table=db.t2\n    - Â•áËøπÂèëÁîü‰∫ÜÔºåÂèØ‰ª•‰∫ÜÔºàÊàëÁåúÊÉ≥Á¨¨‰∏ÄÊ¨°Â∫îËØ•ÊòØÊää`[db.t1,db.t2]`Êï¥‰ΩìÁúãÊàêË°®Âêç‰∫ÜÔºâüò≠\n- Êé•‰∏ãÊù•ÊàëÂèëÁé∞Êï∞ÊçÆÊúâ‰∫ÜÁº∫Â§±ÔºåÊàëÂèà‰∏çÊÉ≥ÈáçÊñ∞Êêû‰∏ªÊï∞ÊçÆÂ∫ì\n    - ÊÉ≥Âà∞‰∏äÊ¨°ÈÅáÂà∞‰∏ªÈîÆÂÜ≤Á™ÅÁöÑÈîôËØØ\n    - ÂÅúÊ≠¢ STOP SLAVE;\n    - ÈáçÁΩÆ reset master; reset slave all  ÈÉΩÂú®‰ªéÊï∞ÊçÆÂ∫ìÊìç‰Ωú\n    - ÂÖÖËÆæ‰∫ãÂä°Âè∑ SET SESSION GTID_NEXT = AUTOMATIC;\n    - Áõ¥Êé•Êää‰∏ªÊï∞ÊçÆÂ∫ìÁé∞Âú®ÁöÑË°®ÂØºÂÖ•Âà∞‰ªéÊï∞ÊçÆÂ∫ì\n    - ``CHANGE MASTER TO\n                    MASTER_HOST='',\n                    MASTER_USER='',\n                    MASTER_PASSWORD='',\n                    MASTER_PORT=3306,\n                    MASTER_LOG_FILE='mysql-bin.000001',\n                    MASTER_LOG_POS=0,  ËøôÈáå‰∏ÄÂÆöË¶Å‰ªéÂ§¥ÂºÄÂßã\n                    MASTER_CONNECT_RETRY=10;``\n    - ÂºÄÂêØ start slave;\n    - ÁÑ∂ÂêéÊü•Áúã SHOW SLAVE STATUS;\n    - Êûú‰∏çÂÖ∂ÁÑ∂ÔºåÊúâ‰∫Ü‰∏ªÈîÆÂÜ≤Á™Å\n    - ËÆ∞‰ΩèÊèêÁ§∫ÁöÑ‰∏ªÈîÆÂÄºÔºåÁÑ∂ÂêéÂú®Ë°®ÈáåÂà†Èô§Â§ß‰∫éÁ≠â‰∫éÁöÑÊâÄÊúâÊï∞ÊçÆ\n    - ÂÅúÊ≠¢ STOP SLAVE;ÂºÄÂêØ start slave;\n- Ëá≥Ê≠§Êï∞ÊçÆÂêåÊ≠•Âï¶ÔºÅÔºÅÔºÅ","tags":["Mysql"],"categories":["ÈöèÁ¨î"]},{"title":"Mysql‰∏ª‰ªéÂêåÊ≠•","url":"/tech-notes/mysql-1561613758.html","content":"#### Êï¥ÁêÜ‰∫Ü‰∏ãÂêÑÁéØÂ¢Émysql‰∏ª‰ªéÂêåÊ≠•ÁöÑÈÖçÁΩÆÊñπÊ≥ï\n\n> 2‰∏™MySQLÊúçÂä°ÈÖçÁΩÆ‰∏ª‰ªé\n````\n#####‰∏ªÊï∞ÊçÆÂ∫ìÈÖçÁΩÆ\nÂú®[mysqld]ÈÖçÁΩÆÊÆµÊ∑ªÂä†Â¶Ç‰∏ãÂ≠óÊÆµ\n\nserver-id=1\nlog-bin=mysql-bin\nlog-slave-updates=1\nbinlog-do-db=  #ÈúÄË¶ÅÂêåÊ≠•ÁöÑÊï∞ÊçÆÂ∫ì,Â¶ÇÊûúÊ≤°ÊúâÊú¨Ë°åË°®Á§∫ÂêåÊ≠•ÊâÄÊúâÁöÑÊï∞ÊçÆÂ∫ì\nbinlog-ignore-db=mysql  #Ë¢´ÂøΩÁï•ÁöÑÊï∞ÊçÆ\ninnodb-file-per-table =ON\nskip_name_resolve=ON\n\nÂú®masterÊú∫‰∏ä‰∏∫slaveÊú∫Ê∑ªÂä†‰∏ÄÂêåÊ≠•Â∏êÂè∑\n mysql>grant replication slave on *.* to 'Áî®Êà∑'@'‰ªéÊï∞ÊçÆÂ∫ìÂú∞ÂùÄ' identified by 'ÂØÜÁ†Å';\n mysql>flush  privileges;\nÈáçÂêØmysqlÊúçÂä°\nÊü•ÁúãÊó•ÂøóÊÉÖÂÜµ\nshow master logs\n|Log_name|File_size|\n|--------|---------|\n|mysql-bin.000016|177|\n|mysql-bin.000017|121680|\n|mysql-bin.000018|201|\n# ËÆ∞‰ΩèÊúÄÂêé‰∏ÄË°åÔºå‰ªéÊúçÂä°Âô®ÂºÄÂêØÂêåÊ≠•Ë¶ÅÁî®Âà∞\n\n#####‰ªéÊï∞ÊçÆÂ∫ìÈÖçÁΩÆ\nÂêåÊ†∑Âú®[mysqld]Â≠óÊÆµ‰∏ãÊ∑ªÂä†Â¶Ç‰∏ãÂÜÖÂÆπ\n\nserver-id=2\nrelay-log= mysql-relay-bin\nread-only=1\nlog-slave-updates=1\nreplicate-do-db= #Ë¶ÅÂêåÊ≠•ÁöÑÊï∞ÊçÆÂ∫ì,‰∏çÂÜôÊú¨Ë°åË°®Á§∫ÂêåÊ≠•ÊâÄÊúâÊï∞ÊçÆÂ∫ì\nreplicate-do-table= #Ë¶ÅÂêåÊ≠•ÁöÑË°®\ninnodb_file_per_table=ON\nskip_name_resolve=ON\nÈáçÂêØmysqlÊúçÂä°\n#####‰ªéÊï∞ÊçÆÂ∫ìÊâßË°åÂëΩ‰ª§\nCHANGE MASTER TO\nMASTER_HOST='‰∏ªÊï∞ÊçÆÂ∫ìÂú∞ÂùÄ',\nMASTER_USER='',\nMASTER_PASSWORD='',\nMASTER_PORT=3306,\n------Âú®‰∏ªÊï∞ÊçÆÂ∫ìÂæóÂà∞----------------\nMASTER_LOG_FILE='mysql-bin.000011',\nMASTER_LOG_POS=107,\n-----------------------------------\nMASTER_CONNECT_RETRY=10;\nÂêØÂä®\nstart slave\nÂÅúÊ≠¢\nstop slave\nÈáçÁΩÆ\nreset slave all\n####ÈîôËØØÊéíÊü•\nshow slave status\n1. Âá∫Áé∞Error 'Can't create database 'test‚Äò; database exists'ÈîôËØØ\nstop slave ;\nset GLOBAL sql_slave_skip_counter=1;\nstart slave;\n````\n#### Ê≥®ÊÑèÊÉÖÂÜµ\n- Ë¶ÅÁ°Æ‰øù‰∏ªÊï∞ÊçÆÂ∫ì3306Á´ØÂè£ÂÖÅËÆ∏Â§ñÈÉ®ËÆøÈóÆÔºåÈòøÈáåÊúçÂä°Âô®ÈúÄË¶ÅÂú®ÂÆâÂÖ®Á≠ñÁï•Ê∑ªÂä†3306Á´ØÂè£\n- ÂÆâË£ÖÂÆùÂ°îÈù¢ÊùøÔºå‰πüË¶ÅÂú®ÂÆâÂÖ®ÈáåÊ∑ªÂä†3306Á´ØÂè£\n- Â¶ÇÊûú‰ΩøÁî®rdsÊúçÂä°Âô®ÔºåÊÉ≥ÊäärdsÊï∞ÊçÆÂêåÊ≠•Âà∞Ëá™Â∑±Êï∞ÊçÆÂ∫ìÔºåÁõ¥Êé•ÊääËá™Â∑±Êï∞ÊçÆÂ∫ìÈÖçÁΩÆ‰∏∫‰ªéÊï∞ÊçÆÂ∫ìÂç≥ÂèØ\n- Âà´Âøò‰∫ÜrdsÊ∑ªÂä†ipÁôΩÂêçÂçï\n#### Êï∞ÊçÆÊò†Â∞Ñ\n> Ë∑®Â∫ìË°®ÂÖ≥ËÅîËß£ÂÜ≥ÊñπÊ≥ï\n> ‰∏öÂä°Âú∫ÊôØÔºöÂÖ≥ËÅî‰∏çÂêåÊï∞ÊçÆÂ∫ì‰∏≠ÁöÑË°®ÁöÑÊü•ËØ¢ÊØîÂ¶ÇËØ¥ÔºåË¶ÅÂÖ≥ËÅîÁöÑË°®ÊòØÔºöÊú∫Âô®A‰∏äÁöÑÊï∞ÊçÆÂ∫ìA‰∏≠ÁöÑË°®A && Êú∫Âô®B‰∏äÁöÑÊï∞ÊçÆÂ∫ìB‰∏≠ÁöÑË°®B„ÄÇ\n````\nÈááÁî®ÁöÑÊòØÂü∫‰∫émysqlÁöÑfederatedÂºïÊìéÁöÑÂª∫Ë°®ÊñπÂºè\nÂª∫Ë°®ËØ≠Âè•Á§∫‰æãÔºöCREATE TABLE `table_name`(......) ENGINE =FEDERATED CONNECTION='mysql://[username]:[password]@[location]:[port]/[db-name]/[table-name]'\nÂâçÊèêÊù°‰ª∂Ôºö‰Ω†ÁöÑmysqlÂæóÊîØÊåÅfederatedÂºïÊìéÔºàÊâßË°åshow engines;ÂèØ‰ª•ÁúãÂà∞ÊòØÂê¶ÊîØÊåÅÔºâ„ÄÇ\n````\n#### ÂÖ≥‰∫éÂºÄÂêØGTID‰∏ª‰ªéÂ§çÂà∂ ÈîôËØØÊéíÊü•\n\n> SHOW SLAVE STATUS; Êü•ÁúãGTIDÈîôËØØÊó∂ÁöÑÁºñÂè∑\n\n- mysql> ¬†STOP SLAVE;\n- mysql> RESET MASTER;\n- mysql> ¬†SET @@GLOBAL.GTID_PURGED ='d09c4417-7238-11e9-816b-ec0d9a7173e0:1-3231547'\n- mysql> ¬†START SLAVE;\n- mysql> ¬†SHOW SLAVE STATUS;\n","tags":["Php","Mysql"],"categories":["ÈöèÁ¨î"]},{"title":"windowsÂú®PowerShell‰ΩøÁî®curlÁöÑ‰∏çÂêå","url":"/tech-notes/cmd-1561450865.html","content":"````\ncURL -XGET 'localhost:9200/library/book/_search'\n\nwindows Èáå‰∏ãÈù¢ËøôÊ†∑ÂÜô\ncurl -Uri http://localhost:9200/library/book/_search -Method GET\n\nÂ¶ÇÊûú‰ΩøhttpsËØ∑Ê±Ç ÂèØËÉΩ‰ºöÊä•‰∏ãÈù¢ËøôÊ†∑ÁöÑÈîôËØØÔºö\n    curl : ËØ∑Ê±ÇË¢´‰∏≠Ê≠¢: Êú™ËÉΩÂàõÂª∫ SSL/TLS ÂÆâÂÖ®ÈÄöÈÅì„ÄÇ\n    ÊâÄÂú®‰ΩçÁΩÆ Ë°å:1 Â≠óÁ¨¶: 1\n    + curl -Uri https://\nËß£ÂÜ≥ÂäûÊ≥ïÔºö\nÂú®ËØ∑Ê±Ç‰πãÂâçÂä†ËøôÊ†∑‰∏ÄÊù°ÂëΩ‰ª§Ôºö[System.Net.ServicePointManager]::SecurityProtocol=[System.Net.SecurityProtocolType]::Tls12\nÊàë‰πü‰∏çÁü•ÈÅìÂï•ÊÑèÊÄùÔºåÂèçÊ≠£‰∏çÊä•Èîô‰∫ÜÔºÅÔºÅÔºÅ\ncurl -Uri https://\n````\n#### ÂÉèPowerShell‰∏çÊîØÊåÅÁöÑÁ¨¶Âè∑[&&]ÔºåÂèëÁé∞Âú®cmdÈáåËøêË°åÊòØÊ≠£Â∏∏ÁöÑÔºÅÔºÅÔºÅ\n> Êü•ÂçäÂ§©ËµÑÊñôÔºåÂéüÊù•Âè™Ë¶ÅÁî®cmdÊâßË°åÂ∞±ÂèØ‰ª•‰∫ÜÔºå‰∏ÄÁõ¥‰ª•‰∏∫PowerShellÂíåcmdÂëΩ‰ª§Â∑•ÂÖ∑ÊòØ‰∏Ä‰∏™‰∏úË•øÔºåÂéüÊù•‰∏ç‰∏ÄÊ†∑„ÄÇ„ÄÇ„ÄÇ","tags":["Linux"],"categories":["ÈöèÁ¨î"]},{"title":"Áî≥ËØ∑HttpsËØÅ‰π¶","url":"/tech-notes/https-1559802916.html","content":"#### ÈÄöËøáacme.shÊñπÂºèËé∑ÂèñËØÅ‰π¶ÁöÑÊñπÊ≥ï\n> centos 7 ‰∏ãÊìç‰Ωú\n\n````\n# ÂÆâË£Ö acme.sh\ncurl https://get.acme.sh | sh\nsource ~/.bashrc\n# ÊõøÊç¢Êàê‰ªéÈòøÈáå‰∫ëÂêéÂè∞Ëé∑ÂèñÁöÑÂØÜÈí•\nexport Ali_Key=\"\"\nexport Ali_Secret=\"\"\n# Êç¢ÊàêËá™Â∑±ÁöÑÂüüÂêç\nacme.sh --issue --dns dns_ali -d lnews.top -d *.lnews.top\n# ÊàêÂäüÂêéÁ®ãÂ∫è‰ºöÈÄöËøáÂÆöÊó∂‰ªªÂä°Ëá™Âä®Êõ¥Êñ∞ËØÅ‰π¶\n# ÂºÄÂêØacme.shËá™Âä®Êõ¥Êñ∞Âà∞ÊúÄÊñ∞ÁâàÊú¨\nacme.sh  --upgrade  --auto-upgrade\n# ÂÖ≥Èó≠Ëá™Âä®Êõ¥Êñ∞\nacme.sh --upgrade  --auto-upgrade  0\n````\n","tags":["Linux"],"categories":["ÈöèÁ¨î"]},{"title":"PhpËé∑ÂèñÂ≠£Â∫¶Á¨¨‰∏ÄÂ§©ÂíåÊúÄÂêé‰∏ÄÂ§©","url":"/tech-notes/php-1558072759.html","content":"````\n#ËøîÂõûÊú¨Â≠£Â∫¶\nfunction  quarter_query($time){\n    $month = date('m',$time);\n    $quarter = floor(($month+2)/3);\n    return $quarter;\n}\n#ËøîÂõûÊú¨Â≠£Â∫¶Á¨¨‰∏ÄÂ§©\nfunction datetime_query_start($quarter,$date=false){\n    $start = mktime(0,0,0,($quarter - 1) *3 +1,1,date('Y'));\n    if($date){\n        return date('Ymd',$start);\n    }\n    return $start;\n}\n#ËøîÂõûÊú¨Â≠£Â∫¶ÊúÄÂêé‰∏ÄÂ§©\nfunction datetime_query_end($quarter,$date=false){\n    $end = mktime(0,0,0,$quarter * 3,date('t',mktime(0, 0 , 0,$quarter*3,1,date(\"Y\"))),date('Y'));\n    if($date){\n        return date('Ymd',$end);\n    }\n    return $end;\n}\n````\n","tags":["Php"],"categories":["ÈöèÁ¨î"]},{"title":"ÂºÄÂêØMysqlÊÖ¢Êó•Âøó","url":"/tech-notes/sql-1557369289.html","content":"#### ÂºÄÂêØmysqlÊÖ¢Êó•ÂøóÂäüËÉΩÔºå‰ºòÂåñÊÖ¢Êü•ËØ¢\n````\nwindows ÊâæÂà∞ my.ini Êñá‰ª∂\nlinux Êâæ my.cnf Êñá‰ª∂\nÊ∑ªÂä†\n[mysqld]\n;ÂºÄÂêØÊÖ¢Êó•Âøó\nslow_query_log = ON\n;ÊÖ¢Êó•ÂøóÂ≠òÊîæË∑ØÂæÑ\nslow_query_log_file = \"d:/wamp/logs/sql_slow.log\"\n;Ë∂ÖËøá 1s ËÆ∞ÂΩï\nlong_query_time = 1\n````","tags":["Mysql"],"categories":["ÈöèÁ¨î"]},{"title":"PhpÂ§öÁ∫øÁ®ãËØ∑Ê±ÇÊé•Âè£","url":"/tech-notes/php-1556436528.html","content":"````\n/**\n * @param $url\n * @param $dataArr\n * @return array\n */\nfunction curl_multi_post($url,$dataArr){\n    $mh = curl_multi_init();\n    foreach($dataArr as $arr){\n        $ch = curl_init();\n        curl_setopt($ch, CURLOPT_URL, $url);\n        curl_setopt($ch,CURLOPT_POST,1);\n        curl_setopt($ch, CURLOPT_POSTFIELDS, $arr);\n        curl_multi_add_handle($mh,$ch);\n    }\n    $active = null;\n    $result = [];\n    do {\n        while (($mrc = curl_multi_exec($mh, $active)) == CURLM_CALL_MULTI_PERFORM) ;\n        if ($mrc != CURLM_OK) { break; }\n        while ($done = curl_multi_info_read($mh)) {\n            $info = curl_getinfo($done['handle']);\n            $error = curl_error($done['handle']);\n            $result[] = curl_multi_getcontent($done['handle']);\n            curl_multi_remove_handle($mh, $done['handle']);\n            curl_close($done['handle']);\n        }\n        if ($active > 0) {\n            curl_multi_select($mh);\n        }\n\n    } while ($active);\n    curl_multi_close($mh);\n    return $result;\n}\n````","tags":["Php"],"categories":["ÈöèÁ¨î"]},{"title":"PhpÊ†πÊçÆÊüê‰∏™ÈîÆÂØπ‰∫åÁª¥Êï∞ÁªÑÊéíÂ∫è","url":"/tech-notes/php-1556098240.html","content":"#### Â∞ÅË£Ö‰∫ÜÊñπÊ≥ï\n````\n/**\n * @param $arr\n * @param null $field  Ë¶ÅÊéíÂ∫èÁöÑÈîÆ\n * @param null $length Ëé∑ÂèñÂâçÂ§öÂ∞ëÊù°ËÆ∞ÂΩï\n * @param $order  SORT_DESC|SORT_ASC\n * @return array|null\n */\nfunction sort_field_arr($arr,$field=null,$length=null,$order){\n    if(empty($field)){\n        return null;\n    }\n    //Ëé∑ÂèñË¶ÅÊéíÂ∫èÁöÑ‰∏ÄÁª¥Êï∞ÁªÑ\n    $arr1 = array_column($arr,$field);\n    //ÊéíÂ∫è\n    array_multisort($arr1,$order,$arr);\n    //ËøîÂõûÈïøÂ∫¶\n    $arr2 = array_slice($arr,0,$length);\n    return $arr2;\n}\n````","tags":["Php"],"categories":["ÈöèÁ¨î"]},{"title":"PHPËé∑ÂèñÁõÆÂΩï‰∏ãÊâÄÊúâÊñá‰ª∂","url":"/tech-notes/php-1555655333.html","content":"\n````\n# ÁõÆÂΩïÂú∞ÂùÄ\n$dir = \"\";\n$fname = [];\n$dir = iconv(\"utf-8\", \"gb2312\", $dir);\n if ($headle = opendir($dir)) {\n        while ($file = readdir($headle)) {\n            $file = iconv(\"gb2312\", \"utf-8\", $file);\n            $fname[] = $file;\n        }\n    }\n # ËØªÂèñÊñá‰ª∂ÂÜÖÂÆπ\n foreach($fname as $fn){\n    # file ÊääÊñá‰ª∂ÂÜÖÂÆπËØªÂèñÂà∞Êï∞ÁªÑ\n    $data = file($dir.$fn);\n    // to do  \n }\n````\n","tags":["Php"],"categories":["ÈöèÁ¨î"]},{"title":"PhpÂÜÖÂ≠òÊ∫¢Âá∫Áà¨Âùë","url":"/tech-notes/php-1554363041.html","content":"#### ÂÜÖÂ≠òÊ∫¢Âá∫ÊÄïÂùë\n\n> ÁâπÁÇπËÆ∞ÂΩïÂ¶Ç‰∏ã\n+ Êü•ËØ¢sqlÊï∞ÊçÆÊó∂ÊúâÊó∂Êó†\n+ ÊääsqlÁ≤òÂà∞sqlÂ∑•ÂÖ∑ÈáåÊï∞ÊçÆÊ≠£Â∏∏\n+ Á©∫ÁôΩÈ°µÈù¢ÊúâÊó∂Âà∑Êñ∞‰∏ãÔºå‰ºöÈáçÊñ∞Âá∫Áé∞Êï∞ÊçÆ\n\n> Ëß£ÂÜ≥ÊñπÊ≥ï\n+ Â¢ûÂä†‰∏¥Êó∂ÂÜÖÂ≠ò`ini_set( 'memory_limit', '1000M' );`\n+ Â¢ûÂä†Ë∂ÖÊó∂Êó∂Èó¥`ini_set(\"max_execution_time\", \"3600\");`\n\n#### Ê£ÄÊü•‰∫Ü‰∏Ä‰∏äÂçàsqlËØ≠Âè•ÔºåÂéüÊù•Êó∂Ëøô‰∏™ÂéüÂõ†ÔºåÈù†ÔºÅ","tags":["Php","Mysql"],"categories":["ÈöèÁ¨î"]},{"title":"PhpÂêàÂπ∂ÈîÆÂÄºÁõ∏ÂêåÁöÑ2‰∏™Êï∞ÁªÑ","url":"/tech-notes/php-1554272920.html","content":"#### ÊàëÁöÑÈúÄÊ±ÇÊòØÊää2‰∏™Ë°®ÁöÑÊï∞ÊçÆÁªüËÆ°ÂêéÔºåÊîæÂú®‰∏Ä‰∏™Êñ∞ÁöÑË°®Èáå\n> Á¨¨‰∏Ä‰∏™Êï∞ÁªÑ\n````\n$arr1 = [\n    [\n        'mid'=>1,\n        'jh_num'=>32\n    ],[\n        'mid'=>2,\n        'jh_num'=>3\n    ],[\n        'mid'=>3,\n        'jh_num'=>5\n    ],[\n        'mid'=>4,\n        'jh_num'=>8\n    ],[\n        'mid'=>5,\n        'jh_num'=>13\n    ]\n]\n````\n> Á¨¨‰∫å‰∏™Êï∞ÁªÑ\n````\n$arr2 = [\n    [\n        'mid'=>2,\n        'dh_num'=>7\n    ],[\n        'mid'=>3,\n        'dh_num'=>23\n    ],[\n        'mid'=>4,\n        'dh_num'=>3\n    ],[\n        'mid'=>5,\n        'dh_num'=>1\n    ],[\n        'mid'=>6,\n        'dh_num'=>3\n    ],[\n        'mid'=>7,\n        'dh_num'=>34\n    ]\n]\n````\n> Êìç‰Ωú\n````\n//ÊèêÂèñmid\n$key1 = array_column($arr1,'mid');\n//Áî®mid‰ΩúÈîÆ\n$arr1 = array_combine($key1,$arr1);\n//Âêå‰∏ä\n$key2 = array_column($arr2,'mid');\n$arr2 = array_combine($key2,$arr2);\n\n//ÂêàÂπ∂ÊèêÂèñÁöÑÈîÆ\n$keys = array_keys(array_flip($key1)+array_flip($key2));\n$arr = []\n//ÈÅçÂéÜ\nforeach ($keys as $key){\n        //Ê≤°ÊúâÂÄºËµãÁ©∫Êï∞ÁªÑÔºà‰∏∫‰∫ÜÁªü‰∏ÄÊ∑ªÂä†Á©∫ÈîÆÔºåÂèØ‰ª•‰∏çÁî®Ôºâ\n        if(empty($arr1[$key])){\n            $arr1[$key] = [\n                'jh_num' => ''\n            ];\n        }\n        if(empty($arr2[$key])){\n            $arr2[$key] = [\n                'dh_num' => ''\n            ];\n        }\n        $arr[] = array_merge($arr1[$key],$arr2[$key]);\n    }\nvar_dump($arr);\n\n//ÁªìÊûú\narray (size=6)\n  0 => \n    array (size=3)\n      'mid' => string '1' (length=1)\n      'jh_num' => string '32' (length=2)\n      'dh_num' => string '' (length=0)\n  1 => \n    array (size=3)\n      'mid' => string '2' (length=1)\n      'jh_num' => string '3' (length=1)\n      'dh_num' => string '7' (length=1)\n  2 => \n    array (size=3)\n      'mid' => string '3' (length=1)\n      'jh_num' => string '5' (length=1)\n      'dh_num' => string '23' (length=2)\n  3 => \n    array (size=3)\n      'mid' => string '4' (length=1)\n      'jh_num' => string '8' (length=1)\n      'dh_num' => string '3' (length=1)\n  4 => \n    array (size=3)\n      'mid' => string '5' (length=1)\n      'jh_num' => string '13' (length=2)\n      'dh_num' => string '1' (length=1)\n  5 => \n    array (size=3)\n      'mid' => string '6' (length=1)\n      'jh_num' => string '' (length=0)\n      'dh_num' => string '3' (length=1)\n  5 => \n    array (size=3)\n      'mid' => string '7' (length=1)\n      'jh_num' => string '' (length=0)\n      'dh_num' => string '34' (length=2)\n````","tags":["Php"],"categories":["ÈöèÁ¨î"]},{"title":"ÂæÆ‰ø°Â∞èÁ®ãÂ∫è‰πãÈü≥‰πêÊí≠Êîæ","url":"/tech-notes/wxmusic-1553936743.html","content":"####  ÂõæÁâáÁöÑÂ∞èÁ®ãÂ∫è‰∏∫ÊúÄÁªàÊïàÊûú\n> ![image_text](/img/2019/wx_xcx.jpg)\n> Èü≥‰πêapiÊé•Âè£ `https://api.i-meto.com/meting/api?server=Èü≥‰πêÂπ≥Âè∞&type=Ê®°Âºè&id=Ê≠åÊõ≤idÊàñÊ≠åÂçïid` \n> ÁΩë‰∏äËøòÊúâÂæàÂ§öÊé•Âè£ÔºåÂ§ßÂÆ∂ÂèØ‰ª•ÂèÇËÄÉÔºåÈùûÂ∏∏ÊÑüË∞¢„ÄêËê®Êë©ÁöÑAPIÁ´ô„ÄëÊèê‰æõ‰∫ÜÊé•Âè£\n\n> //music.js\n````\nconst backgroundAudioManager = wx.getBackgroundAudioManager()\nPage({\n\n  /**\n   * È°µÈù¢ÁöÑÂàùÂßãÊï∞ÊçÆ\n   */\n  data: {\n    isPlaying: false,\n    currentIndex: 0,\n    currentLry: 0,\n    marginTop: 0,\n    datalist: [],\n    progress: 0,\n    currentPosition: '00:00',\n    duration: '00:00',\n    song:'',\n    lry:''\n  },\n  /**\n   * ÁîüÂëΩÂë®ÊúüÂáΩÊï∞--ÁõëÂê¨È°µÈù¢Âä†ËΩΩ\n   */\n  onLoad: function (options) {\n    let that = this\n    let currentIndex = options.currentIndex||0\n    wx.request({\n      url: '‰Ω†ÁöÑÂú∞ÂùÄ',\n      success: (res)=>{\n        console.log(res)\n        that.setData({\n          datalist: res.data,\n        })\n        that.onInit(currentIndex)\n      }\n    })\n  },\n\n  /**\n   * ÁîüÂëΩÂë®ÊúüÂáΩÊï∞--ÁõëÂê¨È°µÈù¢ÂàùÊ¨°Ê∏≤ÊüìÂÆåÊàê\n   */\n  onReady: function () {\n\n  },\n\n  /**\n   * ÁîüÂëΩÂë®ÊúüÂáΩÊï∞--ÁõëÂê¨È°µÈù¢ÊòæÁ§∫\n   */\n  onShow: function () {\n\n  },\n\n  /**\n   * ÁîüÂëΩÂë®ÊúüÂáΩÊï∞--ÁõëÂê¨È°µÈù¢ÈöêËóè\n   */\n  onHide: function () {\n\n  },\n\n  /**\n   * ÁîüÂëΩÂë®ÊúüÂáΩÊï∞--ÁõëÂê¨È°µÈù¢Âç∏ËΩΩ\n   */\n  onUnload: function () {\n\n  },\n\n  /**\n   * È°µÈù¢Áõ∏ÂÖ≥‰∫ã‰ª∂Â§ÑÁêÜÂáΩÊï∞--ÁõëÂê¨Áî®Êà∑‰∏ãÊãâÂä®‰Ωú\n   */\n  onPullDownRefresh: function () {\n\n  },\n\n  /**\n   * È°µÈù¢‰∏äÊãâËß¶Â∫ï‰∫ã‰ª∂ÁöÑÂ§ÑÁêÜÂáΩÊï∞\n   */\n  onReachBottom: function () {\n\n  },\n\n  /**\n   * Áî®Êà∑ÁÇπÂáªÂè≥‰∏äËßíÂàÜ‰∫´\n   */\n  onShareAppMessage: function () {\n    return {\n      title: this.data.song.name,\n      path: '/pages/music/music?currentIndex='+this.data.currentIndex,\n      imageUrl: this.data.song.cover,\n    }\n  },\n  parseLyric: function (lrc_s) {\n    if (lrc_s) {\n      lrc_s = lrc_s.replace(/([^\\]^\\n])\\[/g, (match, p1) => p1 + '\\n[');\n      const lyric = lrc_s.split('\\n');\n      let lrc = [];\n      const lyricLen = lyric.length;\n      for (let i = 0; i < lyricLen; i++) {\n        // match lrc time\n        const lrcTimes = lyric[i].match(/\\[(\\d{2}):(\\d{2})(\\.(\\d{2,3}))?]/g);\n        // match lrc text\n        const lrcText = lyric[i].replace(/.*\\[(\\d{2}):(\\d{2})(\\.(\\d{2,3}))?]/g, '').replace(/<(\\d{2}):(\\d{2})(\\.(\\d{2,3}))?>/g, '').replace(/^\\s+|\\s+$/g, '');\n\n        if (lrcTimes) {\n          // handle multiple time tag\n          const timeLen = lrcTimes.length;\n          for (let j = 0; j < timeLen; j++) {\n            const oneTime = /\\[(\\d{2}):(\\d{2})(\\.(\\d{2,3}))?]/.exec(lrcTimes[j]);\n            const min2sec = oneTime[1] * 60;\n            const sec2sec = parseInt(oneTime[2]);\n            const msec2sec = oneTime[4] ? parseInt(oneTime[4]) / ((oneTime[4] + '').length === 2 ? 100 : 1000) : 0;\n            const lrcTime = min2sec + sec2sec + msec2sec;\n            lrc.push([lrcTime, lrcText]);\n          }\n        }\n      }\n      // sort by time\n      lrc = lrc.filter((item) => item[1]);\n      lrc.sort((a, b) => a[0] - b[0]);\n      return lrc;\n    }\n    else {\n      return [];\n    }\n  },\n  sliceNull: function (lrc) {\n    var result = []\n    for (var i = 0; i < lrc.length; i++) {\n      if (lrc[i][1] == \"\") {\n      } else {\n        result.push(lrc[i]);\n      }\n    }\n    return result\n  },\n  timeToString: function (duration) {\n    let str = '';\n    let minute = parseInt(duration / 60) < 10 ? ('0' + parseInt(duration / 60)) : (parseInt(duration / 60));\n    let second = duration % 60 < 10 ? ('0' + duration % 60) : (duration % 60);\n    str = minute + ':' + second;\n    return str;\n  },\n  onInit: function(index){\n    let that = this\n    //ËÆæÁΩÆÂΩìÂâçÊí≠Êîæ\n    let song = this.data.datalist[index]\n    //Ëé∑ÂèñÊ≠åËØç\n    wx.request({\n      url: song.lrc,\n      success: (res) => {\n        this.setData({\n          currentIndex: index,\n          song: song,\n          lry: that.sliceNull(that.parseLyric(res.data))\n        })\n        let lry = this.data.lry\n\n        backgroundAudioManager.src = this.data.song.url\n        backgroundAudioManager.title = this.data.song.name\n        backgroundAudioManager.singer = this.data.song.artist\n        backgroundAudioManager.coverImgUrl = this.data.song.cover\n        backgroundAudioManager.webUrl = '/pages/music/music?currentIndex='+this.data.currentIndex\n\n        backgroundAudioManager.onTimeUpdate(function () {\n          let currentTime = backgroundAudioManager.currentTime\n          let duration = backgroundAudioManager.duration\n          let index = that.data.currentLry\n          that.setData({\n            progress: currentTime / duration * 100,\n            currentPosition: that.timeToString(parseInt(currentTime)),\n            duration: that.timeToString(parseInt(duration))\n          })\n          if (index > lry.length - 1 || currentTime < lry[index][0] || (!lry[index + 1] || currentTime >= lry[index + 1][0])) {\n            for (let i = 0; i < lry.length; i++) {\n              if (currentTime >= lry[i][0] && (!lry[i + 1] || currentTime < lry[i + 1][0])) {\n                that.setData({\n                  currentLry: i,\n                  marginTop: i * 16\n                })\n              }\n            }\n          }\n          that.onEven()\n        });\n        that.onPlay()\n      }\n    })\n  },\n  selectSong: function(e){\n    let index = e.currentTarget.dataset.index\n    if(index==this.data.currentIndex) return;\n    this.onInit(index)\n    this.setData({\n      isPlaying: false\n    })\n  },\n  onPlay: function(){\n    backgroundAudioManager.play()\n    this.setData({\n      isPlaying: true\n    })\n  },\n  onPause: function(){\n    backgroundAudioManager.pause()\n    this.setData({\n      isPlaying: false\n    })\n  },\n  //ÁõëÂê¨Êí≠Êîæ‰∫ã‰ª∂\n  onEven: function(){\n    let that = this\n    backgroundAudioManager.onStop(function () {\n      that.setData({\n        isPlaying: false\n      })\n    })\n    backgroundAudioManager.onPlay(function () {\n      that.setData({\n        isPlaying: true\n      })\n    })\n    backgroundAudioManager.onPause(function () {\n      that.onPause()\n    })\n    backgroundAudioManager.onEnded(function () {\n      let length = that.data.datalist.length\n      let index = that.data.currentIndex + 1\n      if (index > length) {\n        backgroundAudioManager.stop()\n        this.setData({\n          isPlaying: false\n        })\n      } else {\n        that.onInit(index)\n      }\n    })\n    backgroundAudioManager.onNext(function(){\n      let length = that.data.datalist.length\n      let index = that.data.currentIndex + 1\n      if(index > length){\n        return\n      }else{\n        that.onInit(index)\n      }\n    })\n    backgroundAudioManager.onPrev(function () {\n      let index = that.data.currentIndex - 1\n      if (index < 0) {\n        return\n      } else {\n        that.onInit(index)\n      }\n    })\n  }\n})\n````\n\n> //music.wxml\n````\n<view class=\"aplayer aplayer-withlrc aplayer-withlist\">\n  <view class=\"aplayer-body\">\n    <view class=\"aplayer-pic\" style=\"background-image: url({{song.cover}});background-color: #ad7a86;\">\n      <view wx:if=\"{{!isPlaying}}\" class=\"aplayer-button aplayer-play\" bindtap='onPlay'>\n        <image src=\"/image/play.png\"></image>\n      </view>\n      <view wx:else class=\"aplayer-button aplayer-pause\" bindtap='onPause'>\n        <image src=\"/image/pause.png\"></image>\n      </view>\n    </view>\n    <view class=\"aplayer-info\">\n      <view class=\"aplayer-music\">\n        <text class=\"aplayer-title\">{{song.name}}</text>\n        <text class=\"aplayer-author\"> - {{song.artist}}</text>\n      </view>\n      <view class=\"aplayer-lrc\">\n        <scroll-view class=\"aplayer-lrc-contents\" scroll-y=\"true\" scroll-top=\"{{marginTop}}\">\n          <view wx:for=\"{{lry}}\" wx:key=\"index\" class=\"{{currentLry==index?'aplayer-lrc-current':''}}\">{{item[1]}}</view>\n        </scroll-view>\n      </view>\n      <view class=\"aplayer-controller\">\n        <view class=\"aplayer-bar-wrap\">\n          <progress  class=\"aplayer-bar\" stroke-width=\"2\" activeColor=\"#cdcdcd\" percent=\"{{progress}}\" />\n        </view>\n        <view class=\"aplayer-time\">\n          <view class=\"aplayer-time-inner\">\n            <text>{{currentPosition}}</text>\n            /\n            <text>{{duration}}</text>\n            <view class=\"aplayer-icon\" bindtap='onShareAppMessage'>‚ù§</view>\n          </view>       \n        </view>\n      </view>\n    </view>\n  </view>\n  <view class=\"aplayer-list\">\n    <view wx:for=\"{{datalist}}\" wx:key=\"index\" bindtap='selectSong' data-index='{{index}}'>\n      <text class=\"aplayer-list-cur\" style=\"background-color: #ad7a86;{{currentIndex==index?'display:block':'display:none'}}\"></text>\n      <text class=\"aplayer-list-index\">{{index+1}}</text>\n      <text class=\"aplayer-list-title\">{{item.name}}</text>\n      <text class=\"aplayer-list-author\">{{item.artist}}</text>\n    </view>\n  </view>\n</view>\n````\n\n> //music.wxss  ÂïäÂìàÂìàÂìàÔºåËøôÈáåÁõ¥Êé•ÊääaplayerÁöÑÊ†∑ÂºèÂ§çÂà∂ËøáÊù•ÔºåÊîπ‰∫ÜÊîπ\n> ÊàëÁöÑÊ†∑ÂºèÂÜôÁöÑÂûÉÂúæÁöÑ‰∏çË°åÔºåÊúâÂÜôÁöÑÂ•ΩÁöÑÔºåÂ∏åÊúõËÉΩÊèê‰æõÁöÑÁ≤æÁæéÁöÑÊ®°ÊùøÔºÅÔºÅÔºÅ\n````\n.aplayer {\n    background: #fff;\n    font-family: Arial,Helvetica,sans-serif;\n    margin: 5px;\n    box-shadow: 0 2px 2px 0 rgba(0,0,0,.07), 0 1px 5px 0 rgba(0,0,0,.1);\n    border-radius: 2px;\n    overflow: hidden;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n    line-height: normal;\n    position: relative;\n}\n.aplayer .aplayer-body {\n    position: relative;\n}\n.aplayer.aplayer-withlrc .aplayer-pic {\n    height: 90px;\n    width: 90px;\n}\n.aplayer .aplayer-pic {\n    position: relative;\n    float: left;\n    height: 66px;\n    width: 66px;\n    background-size: cover;\n    background-position: 50%;\n    transition: all .3s ease;\n    cursor: pointer;\n}\n.aplayer .aplayer-pic .aplayer-play {\n    width: 26px;\n    height: 26px;\n    border: 2px solid #fff;\n    bottom: 50%;\n    right: 50%;\n    margin: 0 -15px -15px 0;\n}\n.aplayer .aplayer-pic .aplayer-pause {\n    width: 16px;\n    height: 16px;\n    border: 2px solid #fff;\n    bottom: 4px;\n    right: 4px;\n}\n.aplayer .aplayer-pic .aplayer-play image{\n    position: absolute;\n    top: 3px;\n    left: 5px;\n    height: 20px;\n    width: 20px;\n}\n.aplayer .aplayer-pic .aplayer-pause image{\n    position: absolute;\n    top: 2px;\n    left: 2px;\n    height: 12px;\n    width: 12px;\n}\n.aplayer .aplayer-pic .aplayer-button {\n    position: absolute;\n    border-radius: 50%;\n    opacity: .8;\n    text-shadow: 0 1px 1px rgba(0,0,0,.2);\n    box-shadow: 0 1px 1px rgba(0,0,0,.2);\n    background: rgba(0,0,0,.2);\n    transition: all .1s ease;\n}\n.aplayer .aplayer-info {\n    margin-left: 66px;\n    padding: 14px 7px 0 10px;\n    height: 66px;\n    box-sizing: border-box;\n}\n.aplayer.aplayer-withlrc .aplayer-info {\n    margin-left: 90px;\n    height: 90px;\n    padding: 10px 7px 0;\n}\n.aplayer.aplayer-withlist .aplayer-info {\n    border-bottom: 1px solid #e9e9e9;\n}\n.aplayer .aplayer-info .aplayer-music {\n    overflow: hidden;\n    white-space: nowrap;\n    text-overflow: ellipsis;\n    margin: 0 0 13px 5px;\n    -webkit-user-select: text;\n    -moz-user-select: text;\n    -ms-user-select: text;\n    user-select: text;\n    cursor: default;\n    padding-bottom: 2px;\n    height: 20px;\n}\n.aplayer .aplayer-info .aplayer-music .aplayer-title {\n    font-size: 14px;\n}\n.aplayer .aplayer-info .aplayer-music .aplayer-author {\n    font-size: 12px;\n    color: #666;\n}\n.aplayer .aplayer-lrc {\n    display: none;\n    position: relative;\n    height: 30px;\n    text-align: center;\n    overflow: hidden;\n    margin: -10px 0 7px;\n}\n\n.aplayer.aplayer-withlrc .aplayer-lrc {\n    display: block;\n}\n.aplayer .aplayer-lrc:before {\n    top: 0;\n    height: 10%;\n    background: linear-gradient(180deg,#fff 0,hsla(0,0%,100%,0));\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=\"#ffffff\", endColorstr=\"#00ffffff\", GradientType=0);\n}\n.aplayer .aplayer-lrc:after {\n    bottom: 0;\n    height: 33%;\n    background: linear-gradient(180deg,hsla(0,0%,100%,0) 0,hsla(0,0%,100%,.8));\n    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=\"#00ffffff\", endColorstr=\"#ccffffff\", GradientType=0);\n}\n.aplayer .aplayer-lrc:after, .aplayer .aplayer-lrc:before {\n    position: absolute;\n    z-index: 1;\n    display: block;\n    overflow: hidden;\n    width: 100%;\n    content: \" \";\n}\n.aplayer .aplayer-lrc .aplayer-lrc-contents {\n    width: 100%;\n    transition: all .5s ease-out;\n    -webkit-user-select: text;\n    -moz-user-select: text;\n    -ms-user-select: text;\n    user-select: text;\n    cursor: default;\n    height: 32px\n}\n.aplayer .aplayer-lrc view.aplayer-lrc-current {\n    opacity: 1;\n    overflow: visible;\n    height: auto!important;\n    min-height: 16px;\n}\n.aplayer .aplayer-lrc view {\n    font-size: 12px;\n    color: #666;\n    line-height: 16px!important;\n    height: 16px!important;\n    padding: 0!important;\n    margin: 0!important;\n    transition: all .5s ease-out;\n    opacity: .4;\n    overflow: hidden;\n}\n.aplayer .aplayer-info .aplayer-controller {\n    position: relative;\n    display: flex;\n}\n.aplayer .aplayer-info .aplayer-controller .aplayer-bar-wrap {\n    margin: 0 0 0 5px;\n    padding: 4px 0;\n    cursor: pointer!important;\n    flex: 1;\n}\n.aplayer .aplayer-info .aplayer-controller .aplayer-bar-wrap .aplayer-bar {\n    position: relative;\n    height: 2px;\n    width: 100%;\n    background: #cdcdcd;\n}\n.aplayer .aplayer-info .aplayer-controller .aplayer-time {\n    position: relative;\n    right: 0;\n    bottom: 4px;\n    height: 17px;\n    color: #999;\n    font-size: 11px;\n    padding-left: 7px;\n}\n.aplayer .aplayer-info .aplayer-controller .aplayer-time .aplayer-time-inner {\n    vertical-align: middle;\n}\n.aplayer .aplayer-info .aplayer-controller .aplayer-volume-wrap {\n    position: relative;\n    display: inline-block;\n    margin-left: 3px;\n    cursor: pointer!important;\n}\n.aplayer .aplayer-list {\n    transition: all .5s ease;\n    will-change: height;\n    overflow: hidden;\n}\n.aplayer .aplayer-list view:first-child {\n    border-top: none;\n}\n.aplayer .aplayer-list view {\n    position: relative;\n    height: 32px;\n    line-height: 32px;\n    padding: 0 15px;\n    font-size: 12px;\n    border-top: 1px solid #e9e9e9;\n    cursor: pointer;\n    transition: all .2s ease;\n    overflow: hidden;\n    margin: 0;\n}\n.aplayer .aplayer-list view .aplayer-list-cur {\n    display: none;\n    width: 3px;\n    height: 22px;\n    position: absolute;\n    left: 0;\n    top: 5px;\n    cursor: pointer;\n}\n.aplayer .aplayer-list view .aplayer-list-index {\n    color: #666;\n    margin-right: 12px;\n    cursor: pointer;\n}\n.aplayer .aplayer-list view .aplayer-list-author {\n    color: #666;\n    float: right;\n    cursor: pointer;\n}\n.aplayer .aplayer-icon {\n    width: 15px;\n    height: 15px;\n    border: none;\n    background-color: transparent;\n    outline: 0;\n    cursor: pointer;\n    opacity: .8;\n    vertical-align: middle;\n    padding: 0;\n    font-size: 12px;\n    margin: 0;\n    display: inline-block;\n    line-height: 15px;\n    text-align: center;\n    box-shadow: 0 2px 2px 0 rgba(0,0,0,.07), 0 1px 5px 0 rgba(0,0,0,.1);\n    color: red\n}\n````\n> ËøòÊúâÂàÜ‰∫´Âà∞ÊúãÂèãÂúàÊ≤°ÊúâÂÅöÔºåÊáíÂæóÁ†îÁ©∂‰∫ÜÔºåÊúâ‰ª£Á†ÅÁöÑÂ∞è‰ºô‰º¥ÔºåÊèê‰æõ‰∏Ä‰ªΩÂêßÔºÅÔºÅÔºÅÊÑüË∞¢ÔºÅ","tags":["Èü≥‰πê"],"categories":["ÈöèÁ¨î"]},{"title":"Êü•Áúã2‰∏™Ë°®‰∏çÂêåÁöÑËÆ∞ÂΩï","url":"/tech-notes/sql-1553653512.html","content":"#### Êü•ËØ¢2‰∏™Êó•ÂøóË°®‰∏çÂêåÁöÑËÆ∞ÂΩï\n````\nSELECT * FROM \n(SELECT f_mid,f_keyid,f_php_self,f_php_act,f_query_string,f_fromzd,f_ip,f_date,f_ctime FROM member_fangwen_log \nUNION ALL \nSELECT f_mid,f_keyid,f_php_self,f_php_act,f_query_string,f_fromzd,f_ip,f_date,f_ctime FROM member_fangwen_log_201903) tb1 \nGROUP BY f_mid,f_keyid,f_php_self,f_php_act,f_query_string,f_fromzd,f_ip,f_date,f_ctime HAVING count(*) = 1\n````\n> ÂêàÂπ∂Ëµ∑Êù•Âè™Êúâ‰∏ÄÊù°ÁöÑËÆ∞ÂΩïÔºåÂΩìÁÑ∂ÊòØ‰∏çÁõ∏ÂêåÁöÑÔºåÂ¶ÇÊûúË¶ÅÁõ∏ÂêåËÆ∞ÂΩïÂêéÈù¢ `count(*)>1`","tags":["Mysql"],"categories":["ÈöèÁ¨î"]},{"title":"Á∫ØÈü≥‰πê","url":"/tech-notes/music-1553069533.html","content":"### È´òÊ∏ÖÊó†ÊçüÈü≥‰πêÔºåËØ∑ÂâçÂæÄ[ËôæÁ±≥Èü≥‰πê](https://www.xiami.com/)\n\n{% meting \"778066540\" \"xiami\" \"playlist\" \"mutex:true\" \"listmaxheight:340px\" \"preload:none\" \"theme:#ad7a86\" %}","tags":["Èü≥‰πê"],"categories":["ÈöèÁ¨î"]},{"title":"ÈááÈõÜËÇ°Á•®Êï∞ÊçÆÁ¨¨‰∫åÁØá","url":"/caiji/caiji-1552983122.html","content":"#### ‰∏ãÈù¢‰∏ªË¶ÅÊòØÈíàÂØπ„ÄêËØÅÂà∏ÂÆù„ÄëÊé•Âè£ÁöÑÊìç‰Ωú\n- [ËØÅÂà∏ÂÆù](http://baostock.com)ÊòØ‰∏Ä‰∏™ÂÖçË¥π„ÄÅÂºÄÊ∫êÁöÑËØÅÂà∏Êï∞ÊçÆÂπ≥Âè∞ÔºàÊó†ÈúÄÊ≥®ÂÜåÔºâ„ÄÇ\n\n#### ÁõÆÂΩïÁªìÊûÑ\n- application\n    - `__init__`.py\n    - init.py       `Ëé∑ÂèñÂéÜÂè≤Êï∞ÊçÆÊñá‰ª∂`\n    - common.py     `ÂÖ¨ÂÖ±ÂáΩÊï∞Êñá‰ª∂`\n    - index_pf.py   `Â≠£È¢ëÁõàÂà©ËÉΩÂäõÂÆöÊó∂ËÑöÊú¨`\n    - index_op.py   `Â≠£È¢ëËøêËê•ËÉΩÂäõÂÆöÊó∂ËÑöÊú¨`\n    - Profit.py     `Â≠£È¢ëÁõàÂà©ËÉΩÂäõÊ®°Âûã`\n    - Operation.py  `Â≠£È¢ëËøêËê•ËÉΩÂäõÊ®°Âûã`\n    - GpListInfo.py `ËÇ°Á•®ÂàóË°®Ê®°Âûã`\n    \n#### GpListInfo.py\n````\n# coding:utf-8\nfrom sqlalchemy import Column, String,Integer, create_engine\n#from sqlalchemy.orm import sessionmaker\nfrom sqlalchemy.ext.declarative import declarative_base\n#from sqlalchemy import text\n\n# ÂàõÂª∫ÂØπË±°ÁöÑÂü∫Á±ª:\nBase = declarative_base()\n\nclass GpListInfo(Base):\n    __tablename__ = \"gp_list_info\"\n\n    id = Column(Integer, primary_key=True)\n    ts_code = Column(String(50))   \n    symbol = Column(String(50))        \n    name = Column(String(50))          \n    area = Column(String(50))         \n    industry = Column(String(50))     \n    fullname = Column(String(150))     \n    enname = Column(String(150))      \n    market = Column(String(50))        \n    exchange  = Column(String(50))     \n    curr_type  = Column(String(50))   \n    list_status  = Column(String(50)) \n    list_date  = Column(String(50))    \n    delist_date  = Column(String(50))  \n    is_hs  = Column(String(50))        \n\n    def __init__(self,cursor):\n        self.cursor = cursor\n\n    def get_list_info(self,sql):\n        return self.cursor.execute(sql).fetchall()\n    def set_list_info(self,sql):\n        return self.cursor.execute(sql)\n\n````\n#### Operation.py\n````\n# coding:utf-8\nfrom sqlalchemy import Column, String,Integer, create_engine\nfrom sqlalchemy.orm import sessionmaker\nfrom sqlalchemy.ext.declarative import declarative_base\nfrom sqlalchemy import text\nimport time\n\nBase = declarative_base()\nclass Operation(Base):\n    __tablename__ = \"gp_operation\"\n    id = Column(Integer, primary_key=True)\n    code = Column(String(50))\n    pubDate = Column(String(50))\n    statDate = Column(String(50))\n    NRTurnRatio = Column(String(50))\n    NRTurnDays = Column(String(50))\n    INVTurnRatio = Column(String(50))\n    INVTurnDays = Column(String(50))\n    CATurnRatio = Column(String(50))\n    AssetTurnRatio = Column(String(50))\n    year = Column(Integer)\n    quarter = Column(Integer)\n    ctime = Column(Integer)\n\n    def __init__(self,cursor):\n        self.cursor = cursor\n    def get_operation(self,sql):\n        return self.cursor.execute(sql).fetchall()\n    def set_operation(self,sql):\n        return self.cursor.execute(sql)\n    def query_data(self,bs,code,year,quarter):\n        operation_list = []\n        rs_operation = bs.query_operation_data(code=code, year=year, quarter=quarter)\n        while (rs_operation.error_code == '0') & rs_operation.next():\n             operation_list = rs_operation.get_row_data()\n        if(operation_list):\n            rs_operation.fields.append('year')\n            rs_operation.fields.append('quarter')\n            rs_operation.fields.append('ctime')\n            operation_list.append(year)\n            operation_list.append(quarter)\n            operation_list.append(int(time.time()))\n            sql = \"insert into %s (%s) values %s\" %(self.__tablename__,','.join(rs_profit.fields),tuple(operation_list))\n            self.set_operation(sql)\n        else:\n            return\n\n````\n#### Profit.py\n````\n# coding:utf-8\nfrom sqlalchemy import Column, String,Integer, create_engine\nfrom sqlalchemy.orm import sessionmaker\nfrom sqlalchemy.ext.declarative import declarative_base\nfrom sqlalchemy import text\nimport time\n\nBase = declarative_base()\nclass Profit(Base):\n    __tablename__ = \"gp_profit\"\n    id = Column(Integer, primary_key=True)\n    code = Column(String(50))\n    pubDate = Column(String(50))\n    statDate = Column(String(50))\n    roeAvg = Column(String(50))\n    npMargin = Column(String(50))\n    gpMargin = Column(String(50))\n    netProfit = Column(String(50))\n    epsTTM = Column(String(50))\n    MBRevenue = Column(String(50))\n    totalShare = Column(String(50))\n    liqaShare = Column(String(50))\n    year = Column(Integer)\n    quarter = Column(Integer)\n    ctime = Column(Integer)\n\n    def __init__(self,cursor):\n        self.cursor = cursor\n    def get_profit(self,sql):\n        return self.cursor.execute(sql).fetchall()\n    def set_profit(self,sql):\n        return self.cursor.execute(sql)\n    def query_data(self,bs,code,year,quarter):\n        profit_list = []\n        rs_profit = bs.query_profit_data(code=code, year=year, quarter=quarter)\n        while (rs_profit.error_code == '0') & rs_profit.next():\n             profit_list = rs_profit.get_row_data()           \n        if(profit_list):\n            rs_profit.fields.append('year')\n            rs_profit.fields.append('quarter')\n            rs_profit.fields.append('ctime')\n            profit_list.append(year)\n            profit_list.append(quarter)\n            profit_list.append(int(time.time()))        \n            sql = \"insert into %s (%s) values %s\" %(self.__tablename__,','.join(rs_profit.fields),tuple(profit_list))\n            self.set_profit(sql)\n        else:\n            return\n\n````\n#### common.py\n````\n# coding:utf-8\nimport baostock as bs\nimport time\nfrom sqlalchemy import create_engine\n#from sqlalchemy.orm import sessionmaker\nfrom application.GpListInfo import  *\n\n\n\ndef get_query_by_date():\n    localtime = time.localtime(time.time())\n    year,month = localtime[:2]\n    quarter = (month+2)//3\n    if(quarter==1):\n        return [(year-1,3),(year-1,4)]\n    if(quarter==2):\n        return [(year-1,4),(year,1)]\n    if(quarter==3):\n        return [(year,1),(year,2)]\n    if(quarter==4):\n        return [(year,2),(year,3)]\n\n# Êü•ËØ¢ÊúâÊ≤°ÊúâÊï∞ÊçÆ\ndef get_data(obj,code,year,quarter):\n    where = \" and code='%s' and year=%d and quarter=%d\" %(code,year,quarter)\n    res  = obj.cursor.execute(\"select * from %s where 1 %s\" %(obj.__tablename__,where))\n    if(res.rowcount==0):\n        #Ê≤°Êü•Âà∞Ôºå‰ªéÊé•Âè£Ëé∑Âèñ\n        # ÁôªÈôÜÁ≥ªÁªü\n        lg = bs.login()\n        obj.query_data(bs,code,year,quarter)\n        # ÁôªÂá∫Á≥ªÁªü\n        bs.logout()\n\n# Êï∞ÊçÆÂ∫ìÂÆû‰æã\ndef db():\n    engine = create_engine('mysql+pymysql://root:@localhost:3306/gupiao?charset=utf8&autocommit=true',echo=True)\n    return engine\n\n# Ëé∑ÂèñËÇ°Á•®ÂàóË°®\ndef get_list_info():\n    gp = GpListInfo(db())\n    gp_list = gp.get_list_info(\"select * from %s\" %gp.__tablename__)\n    return gp_list\n\n\n````\n#### init.py\n````\n# coding:utf-8\nimport application.common as common\n\nimport baostock as bs\n\nfrom application.Profit import *\nfrom application.Operation import *\nfrom application.Growth import *\n\ndef insert_data(obj,list):\n    for row in gp_list:\n        code = row['ts_code']\n        for i in range(0,len(year)):\n            for j in range(0,4):\n                bs.login()\n                obj.query_data(bs,code,year[i],quarter[j])\n                bs.logout()\n\nyear = [2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018]\nquarter = [1,2,3,4]\n\n# ËÇ°Á•®ÂàóË°®\ngp_list = common.get_list_info()\n\n# Â≠£È¢ëÁõàÂà©ËÉΩÂäõ\npf = Profit(common.db())\n\n# Â≠£È¢ëËê•ËøêËÉΩÂäõ\nop = Operation(common.db())\ninsert_data(op,gp_list)\n\n\n````\n#### index_pf.py\n````\n# coding:utf-8\n# Â≠£È¢ëÁõàÂà©ËÉΩÂäõ\nimport application.common as common\nfrom application.Profit import  *\n\n# ËÇ°Á•®ÂàóË°®\ngp_list = common.get_list_info()\n\n# \npf = Profit(common.db())\n\nfor row in gp_list:\n    localtime = common.get_query_by_date()\n    for i in range(0,len(localtime)):\n        year = localtime[i][0]\n        quarter = localtime[i][1]\n\n        common.get_data(pf,row.ts_code,year,quarter)\n````\n#### index_op.py\n````\n# coding:utf-8\n# Â≠£È¢ëËê•ËøêËÉΩÂäõ\nimport application.common as common\nfrom application.Operation import  *\n\n# ËÇ°Á•®ÂàóË°®\ngp_list = common.get_list_info()\n\n# \nop = Operation(common.db())\n\nfor row in gp_list:\n    localtime = common.get_query_by_date()\n    for i in range(0,len(localtime)):\n        year = localtime[i][0]\n        quarter = localtime[i][1]\n\n        common.get_data(op,row.ts_code,year,quarter)\n````\n\n#### Ê≥®ÊÑè‰∫ãÈ°π\n> ÂÉèËøôÊ†∑ÁöÑfrom application.Operation import  *ÔºåÂä†ËΩΩ‰∏çËøõÂéªÔºåÂèØ‰ª•ÊääapplicationÂà†‰∫Ü\n> from Operation import  * ËøôÊ†∑Âä†ËΩΩ\n\n> ËøêË°å python3 init.py `[*]`","tags":["Python","ÈááÈõÜ"],"categories":["ÈááÈõÜ"]},{"title":"‰ΩøÁî®ÂÆùÂ°îÂêéÂÆâË£ÖPython3","url":"/tech-notes/pthon3-1552533607.html","content":"#### Âú®‰∏çÂΩ±ÂìçÂÆùÂ°îÈù¢ÊùøÁöÑÊÉÖÂÜµ‰∏ãÔºåÂÆâË£Öpython3.6\n+ pythonÊõ¥Êñ∞Ëø≠‰ª£Âø´ÔºåÁé∞Âú®‰∏ªÊµÅÊ®°ÂùóÈÉΩÊòØpythonÁâàÊú¨3ÁöÑÔºå‰∏ãËΩΩËµÑÊ∫êÂåÖ\n> wget https://www.python.org/ftp/python/3.6.3/Python-3.6.0.tgz\n+ Ëß£Âéã\n> tar -zxvf Python-3.6.0.tgz\n+ ËøõÂÖ•ÂÆâË£ÖÁõÆÂΩï\n> cd Python-3.6.0\n+ ÁºñËØëÔºåÂêéÈù¢‰∏ÄÂÆöË¶ÅÂä†‰∏äÂèòÂºÇÁõÆÂΩïÔºåÈò≤Ê≠¢Ë¶ÜÁõñÂΩ±ÂìçÂÆùÂ°îÈù¢ÊùøÊ≠£Â∏∏ËøêË°å\n> ./configure --prefix=/usr/local/python36\n> make && make install\n+ Âª∫Á´ãËΩØÈìæÊé•Ôºå‰πüÂ∞±ÊòØÁéØÂ¢ÉÂèòÈáè\n> ln -s  /usr/local/python36/bin/python3.6  /usr/bin/python3\n> ln -s  /usr/local/python36/bin/pip3.6  /usr/bin/pip3\n+ Áé∞Âú®Â∞±ÂèØ‰ª•‰ΩøÁî®python3Âíåpip3ÂëΩ‰ª§‰∫Ü\n#### Â¶ÇÊûú‰∏äÈù¢ËæìÂÖ•ÊúâËØØÔºåÂèØ‰ª•Ë¶ÜÁõñÔºåÁúãËá™Â∑±ÊÉÖÂÜµ\n> ln -snf  /usr/local/python36/bin/python3  /usr/bin/python3\n","tags":["Python"],"categories":["ÈöèÁ¨î"]},{"title":"ÈááÈõÜËÇ°Á•®Êï∞ÊçÆÁ¨¨‰∏ÄÁØá","url":"/caiji/caiji-1552468822.html","content":"#### Êàë‰ª¨Âà©Áî®2‰∏™Êèê‰æõÊï∞ÊçÆËé∑ÂèñÁ§æÂå∫Êù•ËææÂà∞ÁõÆÁöÑ\n- [Tushare](https://tushare.pro)ÈáëËûçÂ§ßÊï∞ÊçÆÂºÄÊîæÁ§æÂå∫ÔºàÈúÄË¶ÅÊ≥®ÂÜåÔºâ\n- [ËØÅÂà∏ÂÆù](http://baostock.com)ÊòØ‰∏Ä‰∏™ÂÖçË¥π„ÄÅÂºÄÊ∫êÁöÑËØÅÂà∏Êï∞ÊçÆÂπ≥Âè∞ÔºàÊó†ÈúÄÊ≥®ÂÜåÔºâ„ÄÇ\n\n#### ‰∏ãÈù¢‰∏äpython‰ª£Á†Å\n> ÂÆâË£Ö‰∏ãÈù¢Ê®°ÂùóÂ∫îËØ•‰∏çÂøÖÂ§öËØ¥\n> ÂàõÂª∫Êï∞ÊçÆÂ∫ìgupiao\n> ËøêË°å‰∏ãÈù¢‰ª£Á†ÅÂ∞±‰ºöÂæóÂà∞gp_list_infoËøôÂº†ÂåÖÂê´ÊâÄÊúâËÇ°Á•®Âü∫Êú¨‰ø°ÊÅØÁöÑË°®Ôºà‰Ω†‰πüÂèØ‰ª•Â≠òÊàêÊñá‰ª∂ÔºåÈÇ£Â∞±‰∏ç‰ºöË¶ÅpymysqlÔºåsqlalchemyÊ®°ÂùóÔºâ\n> Ê≥®ÊÑè‰∫ãÈ°πÔºöÂ¶ÇÊûúÂÆâË£ÖtushareÂêéÔºåËøêË°åÊä•Èîôbs4‰ªÄ‰πàÁöÑÔºå‰Ω†Ë¶ÅÂÆâË£ÖËøô‰∏™Ê®°Âùóbeautifulsoup4\n````\n#TushareÈáëËûçÂ§ßÊï∞ÊçÆÂºÄÊîæÁ§æÂå∫\nimport tushare as ts\n#Êìç‰ΩúÊï∞ÊçÆÂ∫ìÊ®°Âùó\nimport pymysql\nfrom sqlalchemy import create_engine\n\nts.set_token('‰Ω†ÁöÑtoken')\npro = ts.pro_api()\n#Êü•ËØ¢ÂΩìÂâçÊâÄÊúâÊ≠£Â∏∏‰∏äÂ∏Ç‰∫§ÊòìÁöÑËÇ°Á•®ÂàóË°®\ndata = pro.stock_basic(exchange='', list_status='L', fields='ts_code,symbol,name,area,industry,fullname,enname,market,exchange,curr_type,list_status,list_date,delist_date,is_hs')\n\n#ËøûÊé•Êï∞ÊçÆÂ∫ì\nengine = create_engine('mysql+pymysql://root:@localhost:3306/gupiao?charset=utf8')\n\n# ÊèíÂÖ•Êï∞ÊçÆ\ndata.to_sql('gp_list_info',con=engine,if_exists='append',index=False)\n````\n> Êé•‰∏ãÊù•Êàë‰ª¨ËØïÁùÄËé∑Âèñ‰∏Ä‰∏ãbaostockÊèê‰æõÁöÑÊï∞ÊçÆÔºàÁî®Ëøô‰∏™‰∏ªË¶ÅÊòØÊ≤°ÈôêÂà∂Ôºå‰ΩÜÊàëÊ≤°ÊâæÂà∞Ëé∑ÂèñÊâÄÊúâËÇ°Á•®ÂàóË°®ÁöÑÊé•Âè£ÔºåÊâÄ‰ª•Áî®‰∏äÈù¢ÈÇ£‰∏™Ëé∑Âèñ‰∏Ä‰∏ãÔºâ\n> Ëé∑Âèñ„ÄêÂ≠£È¢ëÁõàÂà©ËÉΩÂäõ„Äë\n````\n#ËØÅÂà∏ÂÆùwww.baostock.comÊòØ‰∏Ä‰∏™ÂÖçË¥π„ÄÅÂºÄÊ∫êÁöÑËØÅÂà∏Êï∞ÊçÆÂπ≥Âè∞ÔºàÊó†ÈúÄÊ≥®ÂÜåÔºâ„ÄÇ\nimport baostock as bs\nimport pandas as pd\nimport pymysql\nfrom sqlalchemy import create_engine\nimport time;\n\n# ÁôªÈôÜÁ≥ªÁªü\nlg = bs.login()\n\n#ÈìæÊé•Êï∞ÊçÆÂ∫ì\nengine = create_engine('mysql+pymysql://root:@localhost:3306/gupiao')\n#Ëé∑ÂèñËÇ°Á•®‰ª£Á†ÅÂàóË°®\nsql = ''' select ts_code from gp_list_info; '''\ndf = pd.read_sql_query(sql, engine)\n# Êü•ËØ¢Â≠£È¢ë‰º∞ÂÄºÊåáÊ†áÁõàÂà©ËÉΩÂäõ\n\nyear = [2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018]\nquarter = [1,2,3,4]\nfor index,row in df.iterrows():\n    #ËøôÈáåÁî±‰∫é2‰∏™ÁºñÁ†Å‰∏ç‰∏ÄËá¥ÔºåËΩ¨Êç¢‰∏Ä‰∏ã\n    code = row['ts_code'].split('.')\n    code = code[1]+'.'+code[0]\n    for i in range(0,len(year)):\n        for j in range(0,4):            \n            rs_profit = bs.query_profit_data(code=code, year=year[i], quarter=quarter[j])\n            profit_list = []\n            while (rs_profit.error_code == '0') & rs_profit.next():\n                rs_profit.fields.append('year')\n                rs_profit.fields.append('quarter')\n                rs_profit.fields.append('ctime')\n                row_data = rs_profit.get_row_data()\n                row_data.append(year[i])\n                row_data.append(quarter[j])\n                row_data.append(int(time.time()))\n                profit_list.append(row_data)\n                result_profit = pd.DataFrame(profit_list, columns=rs_profit.fields)\n                # ÊèíÂÖ•Êï∞ÊçÆ\n                result_profit.to_sql('gp_profit',con=engine,if_exists='append',index=True)\n    print(index)\n# ÁôªÂá∫Á≥ªÁªü\nbs.logout()\n````\n> OKÔºåËøêË°åÂÆåÂêéÂ∞±ÂèØ‰ª•ÂæóÂà∞2007-2018ÊâÄÊúâÂ≠£Â∫¶ÁöÑÁõàÂà©ËÉΩÂäõÊï∞ÊçÆ‰∫Ü","tags":["Python","ÈááÈõÜ"],"categories":["ÈááÈõÜ"]},{"title":"TensorFlowÂàùÊé¢","url":"/tech-notes/tensorflow-1551755601.html","content":"#### ÂÆâË£ÖËôöÊãüÁéØÂ¢É virtualenv\n> pip install virtualenv\n\n#### ÂàõÂª∫ËôöÊãüÁéØÂ¢É\n> virtualenv --system-site-packages -p python .\\Lzz\\TensorFlow\n\n#### ÊøÄÊ¥ªËôöÊãüÁéØÂ¢É\n> cd .\\Lzz\\TensorFlow\\Scripts\n> activate\n\n#### ÂÆâË£Ö tensorflow\n> pip install tensorflow\n\n#### ËøôÈáåÂÆâË£ÖÂ•Ω‰ΩøÁî®ÁöÑÊó∂ÂÄôÂ¶ÇÊûúÊèêÁ§∫**ImportError: DLL load failed: Êâæ‰∏çÂà∞ÊåáÂÆöÁöÑÊ®°Âùó„ÄÇ**\n> pip uninstall tensorflow ÊääÂéüÊù•ÊúÄÊñ∞ÁâàÊú¨Âç∏ËΩΩ pip install tensorflow==1.9\n> pip uninstall protobuf Âç∏ËΩΩ  pip install protobuf==3.6.0\n> ##### ÊµãËØï‰∫Ü‰∏Ä‰ºöÔºåÂèëÁé∞Âè™Ë¶Å‰∏ãÈù¢ÁöÑÊòØ3.6.0Â∞±ÂèØ‰ª•Ôºå‰∏çË¶ÅÁÆ°tensorflow 1.12.0 has requirement protobuf>=3.6.1, but you'll have protobuf 3.6.0 which is incompatible.Ëøô‰∏™Êä•Èîô\n> pip install protobuf==3.6.0\n> ËøôÈáåÊêû‰∫ÜÂ§ßÂçäÂ§©ÔºåÂ§™‰ªñÂ¶àÂùë‰∫ÜÔºÅÔºÅÔºÅ\n\n#### ÈÄÄÂá∫ËôöÊãüÁéØÂ¢É\n> deactivate\n\n#### ËµÑÊ∫êÈìæÊé•\nÈìæÊé•Ôºöhttps://pan.baidu.com/s/10BGo4NfxQJxGBaKPpcL52Q \nÊèêÂèñÁ†ÅÔºö5yuv ","tags":["Python"],"categories":["ÈöèÁ¨î"]},{"title":"ÈááÈõÜÂ•ΩÁúãÁü≠ËßÜÈ¢ë","url":"/tech-notes/caiji-1551347404.html","content":"Â∫üËØù‰∏çÂ§öËØ¥ÔºåÁ†îÁ©∂‰∫ÜÂ§ßÂçäÂ§©ÔºåÂÆåÊàêÁöÑÊâãÂä®ÈááÈõÜÔºåÊúâËá™Â∑±ÊúçÂä°Âô®ÁöÑÂ∞è‰ºô‰º¥ÂèØ‰ª•Ëá™Âä®ËøêË°åËØïËØï\nÊú¨Âú∞ Áõ¥Êé• php haokan.php Â∞±ÂèØ‰ª•‰∫Ü\n````\n<?php\n/**\n * Created by PhpStorm.\n * User: Lzz\n * Date: 2019/2/28\n * Time: 10:03\n */\nclass Haokan {\n    # ÈÖçÁΩÆ\n    protected $option = [\n        'url' => 'https://sv.baidu.com/',\n        'header' => [\n            'referer: https://sv.baidu.com/',\n            'user-agent: Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Version/10.0 Mobile/14E304 Safari/602.1'\n        ],\n    ];\n    # dom\n    protected $xp;\n    # ÂàÜÁ±ª\n    protected $fenlei=[];\n    # Ëé∑ÂèñÂà∞ÁöÑËßÜÈ¢ëÈìæÊé•\n    protected $vsrc=[];\n\n    public function __construct($option=[])\n    {\n        $this->option = array_merge($this->option,$option);\n    }\n    # Ëé∑ÂèñÂàÜÁ±ª\n    public function get_fenlei(){\n        $list = $this->c_dom($this->option['url'])->xp->query('//div[@class=\"video-tabs-wrapper\"]/ul/li/a');\n        for($i=0;$i<$list->length;$i++){\n            array_push($this->fenlei,[\n                'href' => $list->item($i)->getAttribute('href'),\n                'name' => $list->item($i)->textContent\n            ]);\n        }\n        return $this;\n    }\n    # Ëé∑ÂèñÂàÜÁ±ª‰∏ãÁöÑÁü≠ËßÜÈ¢ëÈìæÊé•\n    public function get_active_sp(){\n        $this->get_fenlei();\n        $t = time();\n        $tt = (time()+1800).'000';\n        foreach ($this->fenlei as $k=>$f){\n            $href = str_replace('#','',$f['href']);\n            $url = \"https://sv.baidu.com/videoui/list/tab?source=wise-channel&pd=&subTab=$href&caller=bdwise\";\n            $list = $this->http_curl($url);\n            preg_match_all('/(?<=data-vsrc=).*?.mp4/',$list,$arr);\n            $this->vsrc[$k] = [\n                'href' => $f['href'],\n                'name' => $f['name'],\n                'list' => [\n\n                ]\n            ];\n            foreach ($arr[0] as $a){\n                if(strlen($a)>255){\n                    unset($a);\n                }\n                array_push($this->vsrc[$k]['list'],str_replace('\\\"','',$a));\n            }\n        }\n        return $this->vsrc;\n    }\n    # ËøôÈáå‰Ω†‰ª¨‰∏çÈúÄË¶Å‰∫Ü\n    # ÂàõÂª∫hexoÊñáÁ´†\n    public function create_hexo(){\n        $this->get_active_sp();\n        $title = 'Â•ΩÁúãÁü≠ËßÜÈ¢ë'.date('Ymd');\n        $date = date('Y-m-d H:i:s');\n        $md = <<<MDTITLE\ntitle: $title\nentitle: ''\nauthor: lzz\navatar: /images/favicon.ico\nauthorLink: 'https://lzz1.top'\nauthorAbout: 'https://lzz1.top'\nauthorDesc: \"Âè¶‰∏Ä‰∏™Êê¨\\U0001F9F1ÁöÑÂä≥ÊñØÂü∫\\U0001F601Ô∏èÔ∏è\"\ncategories: ÈááÈõÜ\ndate: $date\ntags:\n    - ÈááÈõÜ\nkeywords: ÈááÈõÜ\ndescription: Â•ΩÁúãÁü≠ËßÜÈ¢ëÈááÈõÜ\nphotos:\n---\n\nMDTITLE;\n        foreach ($this->vsrc as $v){\n            $md .= <<<MDCONTENT\n### {$v['name']}\\n\nMDCONTENT;\n            foreach ($v['list'] as $kk=>$vv){\n                if(!empty($vv)){\n                    $md .= <<<MDLIST\n> <video style=\"width:50%;max-height:240px\" controls><source src=\"$vv\" type=\"video/mp4\"/></video>\\n\nMDLIST;\n                }\n            }\n\n        }\n        file_put_contents('source/_posts/'.$title.'.md',$md);\n    }\n\n    # ÂàõÂª∫Dom\n    public function c_dom($url){\n        $dom = new DOMDocument('1.0','utf-8');\n        $html = $this->http_curl($url);\n        @$dom->loadHTML($html);\n        $dom->normalize();\n        $xp = new DOMXPath($dom);\n        $this->xp = $xp;\n        return $this;\n    }\n    #\n    public function http_curl($url){\n        $ch = curl_init();\n        curl_setopt($ch, CURLOPT_URL, $url);//Ë¶ÅËÆøÈóÆÁöÑurl\n        curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);\n        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);//httpsÁΩëÁ´ôÂèñÊ∂àsslÈ™åËØÅ\n        curl_setopt($ch,CURLOPT_FOLLOWLOCATION,1);//ÂÖÅËÆ∏30*Ë∑≥ËΩ¨\n        curl_setopt($ch, CURLOPT_TIMEOUT,30);//ËÆæÁΩÆË∂ÖÊó∂Êó∂Èó¥\n        curl_setopt($ch,CURLOPT_HTTPHEADER,$this->option['header']);\n        $response = curl_exec($ch);\n        if ($response === false) {\n            $error_info =  curl_error($ch);\n            echo $error_info;\n            curl_close($ch);//ÂÖ≥Èó≠curl\n            return false;\n        } else {\n            //echo curl_getinfo($ch, CURLINFO_HEADER_OUT);\n            curl_close($ch);//ÂÖ≥Èó≠curl\n            return $response;\n        }\n    }\n}\n$haokan = new Haokan();\n$haokan->create_hexo();\n````","tags":["Php"],"categories":["ÈöèÁ¨î"]},{"title":"phpÂõæÁâáImgickÊâ©Â±ïÁ±ª","url":"/tech-notes/php-1551257711.html","content":"````\nclass Imgick_tool{\n    //ImagickÂØπË±°ÂÆû‰æã\n    public $obj = null;\n    public function __construct()\n    {\n        //Âà§Êñ≠ÊòØÂê¶Âä†ËΩΩ‰∫ÜËØ•Êâ©Â±ï\n        if(!extension_loaded('Imagick'))\n        {\n            return false;\n        }\n        $this->obj = new Imagick();\n    }\n    /*\n\t * png2jpgËΩ¨Êç¢ÂõæÁâáÊ†ºÂºè\n\t *\n\t * @param string src_img Ê∫êÂõæÁâáË∑ØÂæÑ\n\t * @param string dest_img Ë¶ÅÁîüÊàêÁöÑÂõæÁâáÁöÑË∑ØÂæÑ\n\t * @return boolean ËΩ¨Êç¢ÊàêÂÖ±ËøîÂõûtrue  Âê¶Âàôfalse\n\t */\n    public function png2jpg($src_img,$dest_img)\n    {\n        if(!is_object($this->obj))\n        {\n            return false;\n        }\n        try\n        {\n            $this->obj->readImage($src_img);\n            if($this->obj->writeImage($dest_img))\n            {\n                $this->destory();\n                return $dest_img;\n            }\n            return false;\n        }\n        catch (ImagickException $e)\n        {\n            return false;\n        }\n    }\n    /*\n\t * ÂéªÊéâÂõæÁâáÁöÑprofile‰ø°ÊÅØ\n\t *\n\t * @param string src_img Ê∫êÂõæÁâáË∑ØÂæÑ\n\t * @return string src_img ÂõæÁâáÂêçÁß∞ Âê¶ÂàôËøîÂõûfalse\n\t */\n    public function strip_profile($src_img,$dest_img = '')\n    {\n        if(!is_object($this->obj))\n        {\n            return false;\n        }\n        try\n        {\n            $dest_img = empty($dest_img) ? $src_img : $dest_img;\n            $this->obj->readImage($src_img);\n            $this->obj->stripImage ();\n            if($this->obj->writeImage ($dest_img))\n            {\n                $this->destory();\n                return $src_img;\n            }\n            return false;\n        }\n        catch (ImagickException $e)\n        {\n            return false;\n        }\n    }\n    /*\n         * ËÆæÁΩÆjpgÂõæÁâáË¥®Èáè\n         *\n         * @param string src_img Ê∫êÂõæÁâáË∑ØÂæÑ\n         * @param string dest_img Ë¶ÅÁîüÊàêÁöÑÂõæÁâáÁöÑË∑ØÂæÑ\n         * @return boolean ËΩ¨Êç¢ÊàêÂÖ±ËøîÂõûtrue  Âê¶Âàôfalse\n         */\n    public function set_quality($src_img,$quality = 70,$dest_img = '')\n    {\n        if(!is_object($this->obj))\n        {\n            return false;\n        }\n        try\n        {\n            $dest_img = empty($dest_img) ? $src_img : $dest_img;\n            $this->obj->readImage($src_img);\n            $this->obj->setImageCompression(Imagick::COMPRESSION_JPEG);\n            $this->obj->setImageCompressionQuality($quality);\n            if($this->obj->writeImage($dest_img))\n            {\n                $this->destory();\n                return $dest_img;\n            }\n            return false;\n        }\n        catch (ImagickException $e)\n        {\n            return false;\n        }\n    }\n    /*\n      * ÂõæÁâáÁò¶Ë∫´\n      *\n      * @param string src_img Ê∫êÂõæÁâáË∑ØÂæÑ\n      * @param int quality ËÆæÁΩÆÂõæÁâáÂéãÁº©Ë¥®Èáè\n      * @param string dest_img Ë¶ÅÁîüÊàêÁöÑÂõæÁâáÁöÑË∑ØÂæÑ\n      * @return boolean ËΩ¨Êç¢ÊàêÂÖ±ËøîÂõûtrue  Âê¶Âàôfalse\n      */\n    public function slimming($src_img,$quality = 60,$dest_img = '')\n    {\n        if(!is_object($this->obj))\n        {\n            return false;\n        }\n        try\n        {\n            $dest_img = empty($dest_img) ? $src_img : $dest_img;\n            $this->obj->readImage($src_img);\n            $this->obj->setImageFormat('jpeg');\n            $this->obj->setImageCompression(Imagick::COMPRESSION_JPEG);\n            //Â∞ÜÂõæÁâáÁöÑË¥®ÈáèÈôç‰ΩéÂà∞ÂéüÊù•ÁöÑ60%\n            $quality = $this->obj->getImageCompressionQuality() * $quality / 100;\n            $this->obj->setImageCompressionQuality($quality);\n            $this->obj->stripImage();\n\n            if($this->obj->writeImage($dest_img))\n            {\n                $this->destory();\n                return $dest_img;\n            }\n            return false;\n        }\n        catch (ImagickException $e)\n        {\n            return false;\n        }\n    }\n    /*\n\t * ÁîüÊàêÁº©Áï•Âõæ\n\t *\n\t * @param string src_img Ê∫êÂõæÁâáË∑ØÂæÑ\n\t * @param int quality ËÆæÁΩÆÂõæÁâáÂéãÁº©Ë¥®Èáè\n\t * @param string dest_img Ë¶ÅÁîüÊàêÁöÑÂõæÁâáÁöÑË∑ØÂæÑ\n\t * @return boolean ËΩ¨Êç¢ÊàêÂÖ±ËøîÂõûtrue  Âê¶Âàôfalse\n\t */\n    public function thump($src_img,$width = 250,$height = '')\n    {\n        if(!is_object($this->obj))\n        {\n            return false;\n        }\n        try\n        {\n\n            $file_info = pathinfo($src_img);\n            //ÁîüÊàêÁº©Áï•ÂõæÂêçÁß∞\n            $file_name = substr($file_info['basename'],0,strrpos($file_info['basename'],'.'));\n            $dest_img = $file_info['dirname'] . '/' . $file_name . '_thump.' . $file_info['extension'];\n            $this->obj->readImage($src_img);\n            //ËÆ°ÁÆóË¶ÅËé∑ÂæóÁº©Áï•ÂõæÁöÑÈ´òÂ∫¶\n            $img_width = $this->obj->getImageWidth();\n            $img_height = $this->obj->getImageHeight();\n            $dest_height = $img_height * ($width / $img_width);\n            $this->obj->resizeImage($width, $dest_height, Imagick::FILTER_CATROM, 1, false);\n            //ÁîüÊàêÂõæÁâá\n            if($this->obj->writeImage($dest_img))\n            {\n                $this->destory();\n                return $dest_img;\n            }\n            return false;\n        }\n        catch (ImagickException $e)\n        {\n            return false;\n        }\n    }\n    /*\n\t * ÈáäÊîæËµÑÊ∫ê\n\t *\n\t */\n    function destory()\n    {\n        if(is_object($this->obj))\n        {\n            $this->obj->clear();\n\n            $this->obj->destroy();\n        }\n    }\n}\n````","tags":["Php"],"categories":["ÈöèÁ¨î"]},{"title":"Hexo‰ΩøÁî®gitalkËØÑËÆ∫","url":"/tech-notes/gitalk-1551239869.html","content":"‰ªäÂ§©ÂèëÁé∞gitÊèê‰æõ‰∫ÜËØÑËÆ∫ÁöÑapiÔºåÁ´ãÈ©¨ËàçÂºÉÂéüÊù•ÁöÑvalineüòÇÔºåÊØïÁ´üËøô‰∏™Á´ôÊâòÁÆ°Âú®gitÔºåÂΩìÁÑ∂Ë¶ÅÂÖ®ÈÉ®gitÂåñ„ÄÇ\n- Áî≥ËØ∑githubÂ∫îÁî®ÔºåÁÇπÂáªÊàë**[‰º†ÈÄÅÈó®](https://github.com/settings/applications/new)**\n- Áî≥ËØ∑Â•Ω‰ª•ÂêéÔºåÂú®Ê®°ÊùøÈáåÂºïÂÖ•‰∏ãÈù¢‰ª£Á†Å\n````\n<% if (theme.comments.enable && page.comments){ %>\n<section id=\"comments\">\n    <div id=\"gitalk-container\" style=\"margin: 30px;\"></div>\n    <link rel=\"stylesheet\" href=\"https://unpkg.com/gitalk/dist/gitalk.css\">\n    <script src=\"https://unpkg.com/gitalk/dist/gitalk.min.js\"></script>\n    <script>\n        var gitalk = new Gitalk({\n            clientID: '<%= theme.comments.clientID %>',\n            clientSecret: '<%= theme.comments.clientSecret %>',\n            repo: '<%= theme.comments.repo %>',\n            owner: '<%= theme.comments.owner %>',\n            admin: ['<%= theme.comments.admin.join(',') %>'],\n            id: '<%= page.title %>',      // Ensure uniqueness and length less than 50\n            distractionFreeMode: false  // Facebook-like distraction free mode\n        })\n\n        gitalk.render('gitalk-container')\n    </script>\n</section>\n<% } %>\n````\n- ‰∏ªÈ¢òÈÖçÁΩÆ\n````\ncomments:\n  enable: true\n  clientID: ‰∏äÈù¢Áî≥ËØ∑ÁöÑ\n  clientSecret: ‰∏äÈù¢Áî≥ËØ∑ÁöÑ\n  repo: lnew.github.io  ‰ªìÂ∫ìÔºåËøôÊòØÊàëÁöÑÔºåÊ∑ª‰Ω†Ëá™Â∑±ÁöÑ\n  owner: lnew Êã•ÊúâËÄÖ\n  admin:\n    - lnew ÁÆ°ÁêÜÂëò\n````\n#### Â•Ω‰∫ÜÔºåËøôÂ∞±ok‰∫ÜÔºåÁî®Ëá™Â∑±githubÁôªÂΩïÂàùÂßãÂåñ‰∏Ä‰∏ãËØïËØïÂêß","tags":["Hexo"],"categories":["ÈöèÁ¨î"]},{"title":"ËΩ¨ÂåñÊï∞ÁªÑ‰∏∫Ê†ëÂΩ¢ÁªìÊûÑ","url":"/tech-notes/tree-1551161827.html","content":"````\nfunction list_to_tree($list, $pk='id', $pid = 'pid', $child = 'children', $root = 0, $strict = false) {\n        // ÂàõÂª∫Tree\n        $tree = array();\n        if (is_array($list)) {\n            // ÂàõÂª∫Âü∫‰∫é‰∏ªÈîÆÁöÑÊï∞ÁªÑÂºïÁî®\n            $refer = array();\n            foreach ($list as $key => $data) {\n                $refer[$data[$pk]] =& $list[$key];\n            }\n            foreach ($list as $key => $data) {\n                // Âà§Êñ≠ÊòØÂê¶Â≠òÂú®parent\n                $parent_id = $data[$pid];\n                if ($parent_id === null || (int)$root === $parent_id) {\n                    $tree[] =& $list[$key];\n                } else {\n                    if(isset($refer[$parent_id])){\n                        $parent =& $refer[$parent_id];\n                        $parent[$child][] =& $list[$key];\n                    } else {\n                        if($strict === false){\n                            $tree[] =& $list[$key];\n                        }\n                    }\n                }\n            }\n        }\n        return $tree;\n    }\n````","tags":["Php"],"categories":["ÈöèÁ¨î"]},{"title":"ÂØπÂïÜÂìÅÊêúÁ¥¢ÂÖ≥ÈîÆÂ≠ó‰ºòÂåñ","url":"/tech-notes/-1551078946.html","content":"````\nÂ¶ÇÈÅáÂà∞Ôºå„ÄêËÅîÊÉ≥(Lenovo)C1530Èü≥ÁÆ±Èü≥ÂìçÁîµËÑëÂè∞ÂºèÊú∫Á¨îËÆ∞Êú¨ÁîµËÑëÈü≥ÁÆ±Â•óË£Ö‰ΩéÈü≥ÁÇÆ„ÄëËøôÊ†∑ÁöÑÂêçÂ≠óÔºåÊü•ËØ¢„ÄêËÅîÊÉ≥Á¨îËÆ∞Êú¨„ÄëÂ∞±ÂèØ‰ª•Êü•Âá∫Êù•\nif(!empty($keyword)){\n        $i = 0;\n        $where .= \" and g_name like '\";\n        while(mb_substr($keyword,$i, 1, 'utf-8')){\n            $str = mb_substr($keyword, $i, 1, 'utf-8');\n            $where .= \"%{$str}\";\n            $i++;\n        }\n        $where .= \"%'\";\n    }\n````\n","tags":["Php","Mysql"],"categories":["ÈöèÁ¨î"]},{"title":"MysqlÂç†‰ΩçÊü•ËØ¢","url":"/tech-notes/mysql-1551078249.html","content":"````\n$sql = \"SELECT id,name FROM table WHERE 1\"\nÂÅáÂ¶ÇÊàëË¶ÅÂú®idÂíåname‰πãÈó¥ÊèíÂÖ•‰∏ÄÂàóÔºåËøò‰∏çÊÉ≥ÈáçÁªÑÊï∞ÊçÆÔºåÈÇ£Â∞±ÂèØ‰ª•Âú®Êü•ËØ¢ÁöÑÊó∂ÂÄôÂç†‰Ωç\n$sql = \"SELECT id,(@title :='') title,name FROM table WHERE 1\"\n$row = db_arr($sql)\nËøôÊ†∑Êü•ÂÆåÂêéÔºåÈÅçÂéÜÁªôtitleËµãÂÄº\nforeach($row as $v){\n    $v['title'] = \n}\n#Âº∫Âà∂‰ΩøÁî®Á¥¢Âºï--‰∏çÁü•ÈÅì‰∏∫Âï•‰∏çËµ∞Á¥¢Âºï„ÄÇ„ÄÇ„ÄÇ\nSELECT * from member_order FORCE INDEX(ctime) where ctime>='1546272000'\n````","tags":["Php","Mysql"],"categories":["ÈöèÁ¨î"]},{"title":"Jstree‰ΩøÁî®ËÆ∞ÂΩï","url":"/tech-notes/jstree-1550931747.html","content":"````\n$(\"#treeview\").jstree({\n            \"themes\": {\"stripes\": true},\n            \"checkbox\": {\n                \"keep_selected_style\": false,\n            },\n            \"types\": {\n                \"root\": {\n                    \"icon\": \"fa fa-folder-open\",\n                },\n                \"menu\": {\n                    \"icon\": \"fa fa-folder-open\",\n                },\n                \"file\": {\n                    \"icon\": \"fa fa-file-o\",\n                }\n            },\n            \"plugins\": [\"checkbox\", \"types\"],\n            \"core\": {\n                'check_callback': true,\n                \"data\": {{$tree}}\n    }\n    });\n        //ËØªÂèñÈÄâ‰∏≠ÁöÑÊù°ÁõÆ\n        $.jstree.core.prototype.get_all_checked = function (full) {\n            var obj = this.get_selected(), i, j;\n            for (i = 0, j = obj.length; i < j; i++) { obj = obj.concat(this.get_node(obj[i]).parents); } obj = $.grep(obj, function (v, i, a) { return v != '#'; }); obj = obj.filter(function (itm, i, a) { return i == a.indexOf(itm); }); return full ? $.map(obj, $.proxy(function (i) { return this.get_node(i); }, this)) : obj; }; // if ($(\"#treeview\").size() > 0) {\n//            var r = $(\"#treeview\").jstree(\"get_all_checked\");\n//            $(\"input[name='a_power']\").val(r.join(','));\n//        }\n        //ÂÖ®ÈÄâÂíåÂ±ïÂºÄ\n        $(document).on(\"click\", \"#checkall\", function () {\n            $(\"#treeview\").jstree($(this).prop(\"checked\") ? \"check_all\" : \"uncheck_all\");\n        });\n        $(document).on(\"click\", \"#expandall\", function () {\n            $(\"#treeview\").jstree($(this).prop(\"checked\") ? \"open_all\" : \"close_all\");\n        });\n        $(\"#treeview\").on(\"ready.jstree\", function (e, obj) {   //Ê†ëÂàõÂª∫ÂÆåÊàê‰∫ã‰ª∂\n            //obj.instance.open_all();    //Â±ïÂºÄÊâÄÊúâËäÇÁÇπ\n        });\n        $(\"#treeview\").on('changed.jstree', function (e, data) {   //ÈÄâ‰∏≠ËäÇÁÇπÊîπÂèò‰∫ã‰ª∂\n            //Ëé∑ÂèñÊâÄÊúâÈÄâ‰∏≠È°πÁõÆÂèäÂ≠êÈ°πÁõÆ\n            var r = $(\"#treeview\").jstree(\"get_all_checked\");\n            $(\"input[name='a_power']\").val(r.join(','));\n        });\n````\n","tags":["Javascript"],"categories":["ÈöèÁ¨î"]},{"title":"ExcelÊó∂Èó¥Êà≥ËΩ¨Êç¢Êó•Êúü","url":"/tech-notes/excel_time-1550931509.html","content":"ÊúâÊó∂ÂÄôÁõ¥Êé•ÂØºÂá∫Êï∞ÊçÆÂ∫ìÊï∞ÊçÆÔºåÊó∂Èó¥ÊòØÊó∂Èó¥Êà≥Ê†ºÂºèÁöÑËØùÁúãËµ∑Êù•‰∏çÊñπ‰æøÔºåÊúâ‰∫Ü‰∏ãÈù¢ÂÖ¨Âºè\n> =TEXT((C4/1000+8*3600)/86400+70*365+19,\"yyyy-mm-dd hh:mm:ss\")\nC4‰∏∫Êó∂Èó¥Êà≥ÂçïÂÖÉÊ†ºÔºàÂçï‰ΩçÊØ´ÁßíÔºåÁßí‰∏çÁî®/1000Ôºâ","tags":["Excel"],"categories":["ÈöèÁ¨î"]},{"title":"SqlÊü•ÊâæÈáçÂ§çÊï∞ÊçÆÔºåÂπ∂‰øùÁïô‰∏ÄÊù°","url":"/tech-notes/sql-1550807545.html","content":"````\n#Êü•ËØ¢ÈáçÂ§çÊï∞ÊçÆÔºåÂíåÈáçÂ§çÊ¨°Êï∞\nselect id,count(*) as count from table group by ÈáçÂ§çÂ≠óÊÆµ having count>1;\n#ËøôÈáå‰øùÁïôIDÊúÄÂ§ß‰∏ÄÊù°ËÆ∞ÂΩï\nDelete FROM table Where id Not In (SELECT a.id FROM (Select Max(id) id From table Group By ÈáçÂ§çÂ≠óÊÆµ) a)\n````\nÊîπ‰∏ÄÊîπÔºåÊÄª‰ºöÈÄÇÂêà‰Ω†","tags":["Mysql"],"categories":["ÈöèÁ¨î"]},{"title":"Êï∞ÊçÆË°®2Êù°Êï∞ÊçÆÁõ∏ÈÇªÁöÑÊó∂Èó¥Â∑Æ","url":"/tech-notes/sql-1550807208.html","content":"````\nfunction run(){\n    $start = date('Ymd');\n    $sql = \"SELECT A.f_id,A.f_mid,A.f_ctime,B.f_ctime,(B.f_ctime-A.f_ctime) diff FROM\n(SELECT f_id,f_mid,f_ctime,(@i := @i + 1) as ord_num from member_fangwen_log a,(select @i := 1) d WHERE f_date={$start} AND f_shichang<0 order by f_mid limit 5000) A\nLEFT JOIN\n(SELECT f_id,f_mid,f_ctime,(@j := @j + 1) as ord_num from member_fangwen_log a,(select @j := 0) c WHERE f_date={$start} AND f_shichang<0 order by f_mid limit 5000) B\non A.ord_num=B.ord_num AND A.f_mid=B.f_mid\";\n    $rows = db_arr($sql);\n    foreach ($rows as $val){\n        !empty($val['diff'])?$val['diff']:$val['diff']=0;\n        $sql = \"UPDATE member_fangwen_log SET f_shichang={$val['diff']} WHERE f_id={$val['f_id']} AND f_shichang<0 limit 1\";\n        $res = db_exec($sql);\n    }\n}\n````\nÂèØ‰ª•ËÆ°ÁÆóÂá∫ÊØè‰∏™Áî®Êà∑Áõ∏ÈÇª2Êù°ËÆøÈóÆËÆ∞ÂΩï‰πãÈó¥ÁöÑÊó∂Èïø","tags":["Mysql"],"categories":["ÈöèÁ¨î"]},{"title":"ÂõæÁâá‰∏ä‰º†È¢ÑËßà","url":"/tech-notes/upload-1550806771.html","content":"````\n//ËøôÈáåÊòØÈÄâÊã©ÂõæÁâáÁöÑÊìç‰Ωú\n$('#image').change(function () {\n        var pattern = /(\\.*.jpg$)|(\\.*.png$)|(\\.*.gif$)|(\\.*.jpeg)/;\n        if (!pattern.test($(this).val())) {\n            $('#toast').modal('show');\n            $('.modtis').text('Á≥ªÁªü‰ªÖÊîØÊåÅjpg/png/gifÊ†ºÂºèÁöÑÁÖßÁâáÔºÅ');\n            this.focus();\n            $(this).val(\"\");\n            return false;\n        }\n        var file = $(this)[0].files[0];\n        var path = getObjectURL(file);\n        $('#img-thumbnail').attr('src',path);\n    });\n//Ëøô‰∏™ÂáΩÊï∞‰∏∫‰∏çÂêåÊµèËßàÂô®Ëé∑ÂèñÂõæÁâáË∑ØÂæÑ\nfunction getObjectURL(file) {\n    var url = null;\n    if (window.createObjectURL != undefined) { // basic\n        url = window.createObjectURL(file);\n    } else if (window.URL != undefined) { // mozilla(firefox)\n        url = window.URL.createObjectURL(file);\n    } else if (window.webkitURL != undefined) { // webkit or chrome\n        url = window.webkitURL.createObjectURL(file);\n    }\n    return url;\n}\n````","tags":["Javascript"],"categories":["ÈöèÁ¨î"]},{"title":"Php‰∏ãËΩΩÊúÄÊñ∞ÁâàÊú¨Êñá‰ª∂Âà∞Êú¨Âú∞","url":"/tech-notes/php-1550806263.html","content":"ÊØîËæÉÁâàÊú¨Âè∑ÔºåÁÑ∂Âêé‰∏ãËΩΩ\n````\nif(version_compare($version1,$version2,'<')){\n        $file = $row['a_url'];\n        $filename = basename($file);\n        header(\"Content-type: application/octet-stream\");\n        $ua = $_SERVER[\"HTTP_USER_AGENT\"];\n        $encoded_filename = rawurlencode($filename);\n        if (preg_match(\"/MSIE/\", $ua)) {\n            header('Content-Disposition: attachment; filename=\"' . $encoded_filename . '\"');\n        } else if (preg_match(\"/Firefox/\", $ua)) {\n            header(\"Content-Disposition: attachment; filename*=\\\"utf8''\" . $filename . '\"');\n        } else {\n            header('Content-Disposition: attachment; filename=\"' . $filename . '\"');\n        }\n\n        header(\"Content-Length: \". filesize($file));\n        ob_clean();\n        flush();\n        readfile($file);\n        exit();\n    }\n````\n","tags":["Php"],"categories":["ÈöèÁ¨î"]},{"title":"LinuxÂêéÂè∞ËøêË°åphpÊñá‰ª∂","url":"/tech-notes/linux-1550804225.html","content":"Âπ≥Êó∂‰ºöÈÅáÂà∞‰∏ÄÊ¨°ÊÄßÂ§ÑÁêÜÂ§ßÈáèÊï∞ÊçÆÁöÑÈóÆÈ¢òÔºåËøôÊòØÂ∞±ÈúÄË¶ÅÂÜô‰∏™ËÑöÊú¨ÂéªÂêéÂè∞Ëá™Âä®ËøêË°å\n````\nnohup php index.php &\nÁõ∏ÂΩì‰∫éÂÆàÊä§ËøõÁ®ã\n\ntail -f nohup.out\nÊü•ÁúãËøêË°åÊÉÖÂÜµ\n\nps -ef | grep inde.php\nÊü•ÁúãËøõÁ®ã\n\nps aux\nÊü•ÁúãÂÖ®ÈÉ®ËøõÁ®ã\n\nkell -9 [pid]\nÁªìÊùüËøõÁ®ã\n````\nÂõ†‰∏∫ÊàëÂÜôÁöÑÊòØphpÊñá‰ª∂ÔºåÊâÄ‰ª•ÈúÄË¶ÅphpÁéØÂ¢É","tags":["Php","Linux"],"categories":["ÈöèÁ¨î"]},{"title":"ÂõæÁâáÂéãÁº©Á±ªÂ∫ì","url":"/tech-notes/image-1550755430.html","content":"‰ªäÂ§©Ë¶ÅÊâπÈáèÂéãÁº©ÂõæÁâáÔºåÁÑ∂ÂêéÂ∞±ÊêúÂà∞‰∫Ü‰∏Ä‰∫õÁ±ªÂíåÊñπÊ≥ïÔºå‰øÆÊîπ‰∫Ü‰∏ãÔºåËØï‰∫ÜËØïÔºåÈÉΩÊå∫‰∏çÈîôÔºåËÆ∞ÂΩï‰∏Ä‰∏ã\n\n#### PHPÁöÑÁ±ª\n```\nclass Imgick_tool{\n    //ImagickÂØπË±°ÂÆû‰æã\n    public $obj = null;\n    public function __construct()\n    {\n        //Âà§Êñ≠ÊòØÂê¶Âä†ËΩΩ‰∫ÜËØ•Êâ©Â±ï\n        if(!extension_loaded('Imagick'))\n        {\n            return false;\n        }\n        $this->obj = new Imagick();\n    }\n    /*\n\t * png2jpgËΩ¨Êç¢ÂõæÁâáÊ†ºÂºè\n\t *\n\t * @param string src_img Ê∫êÂõæÁâáË∑ØÂæÑ\n\t * @param string dest_img Ë¶ÅÁîüÊàêÁöÑÂõæÁâáÁöÑË∑ØÂæÑ\n\t * @return boolean ËΩ¨Êç¢ÊàêÂÖ±ËøîÂõûtrue  Âê¶Âàôfalse\n\t */\n    public function png2jpg($src_img,$dest_img)\n    {\n        if(!is_object($this->obj))\n        {\n            return false;\n        }\n        try\n        {\n            $this->obj->readImage($src_img);\n            if($this->obj->writeImage($dest_img))\n            {\n                $this->destory();\n                return $dest_img;\n            }\n            return false;\n        }\n        catch (ImagickException $e)\n        {\n            return false;\n        }\n    }\n    /*\n\t * ÂéªÊéâÂõæÁâáÁöÑprofile‰ø°ÊÅØ\n\t *\n\t * @param string src_img Ê∫êÂõæÁâáË∑ØÂæÑ\n\t * @return string src_img ÂõæÁâáÂêçÁß∞ Âê¶ÂàôËøîÂõûfalse\n\t */\n    public function strip_profile($src_img,$dest_img = '')\n    {\n        if(!is_object($this->obj))\n        {\n            return false;\n        }\n        try\n        {\n            $dest_img = empty($dest_img) ? $src_img : $dest_img;\n            $this->obj->readImage($src_img);\n            $this->obj->stripImage ();\n            if($this->obj->writeImage ($dest_img))\n            {\n                $this->destory();\n                return $src_img;\n            }\n            return false;\n        }\n        catch (ImagickException $e)\n        {\n            return false;\n        }\n    }\n    /*\n         * ËÆæÁΩÆjpgÂõæÁâáË¥®Èáè\n         *\n         * @param string src_img Ê∫êÂõæÁâáË∑ØÂæÑ\n         * @param string dest_img Ë¶ÅÁîüÊàêÁöÑÂõæÁâáÁöÑË∑ØÂæÑ\n         * @return boolean ËΩ¨Êç¢ÊàêÂÖ±ËøîÂõûtrue  Âê¶Âàôfalse\n         */\n    public function set_quality($src_img,$quality = 70,$dest_img = '')\n    {\n        if(!is_object($this->obj))\n        {\n            return false;\n        }\n        try\n        {\n            $dest_img = empty($dest_img) ? $src_img : $dest_img;\n            $this->obj->readImage($src_img);\n            $this->obj->setImageCompression(Imagick::COMPRESSION_JPEG);\n            $this->obj->setImageCompressionQuality($quality);\n            if($this->obj->writeImage($dest_img))\n            {\n                $this->destory();\n                return $dest_img;\n            }\n            return false;\n        }\n        catch (ImagickException $e)\n        {\n            return false;\n        }\n    }\n    /*\n      * ÂõæÁâáÁò¶Ë∫´\n      *\n      * @param string src_img Ê∫êÂõæÁâáË∑ØÂæÑ\n      * @param int quality ËÆæÁΩÆÂõæÁâáÂéãÁº©Ë¥®Èáè\n      * @param string dest_img Ë¶ÅÁîüÊàêÁöÑÂõæÁâáÁöÑË∑ØÂæÑ\n      * @return boolean ËΩ¨Êç¢ÊàêÂÖ±ËøîÂõûtrue  Âê¶Âàôfalse\n      */\n    public function slimming($src_img,$quality = 60,$dest_img = '')\n    {\n        if(!is_object($this->obj))\n        {\n            return false;\n        }\n        try\n        {\n            $dest_img = empty($dest_img) ? $src_img : $dest_img;\n            $this->obj->readImage($src_img);\n            $this->obj->setImageFormat('jpeg');\n            $this->obj->setImageCompression(Imagick::COMPRESSION_JPEG);\n            //Â∞ÜÂõæÁâáÁöÑË¥®ÈáèÈôç‰ΩéÂà∞ÂéüÊù•ÁöÑ60%\n            $quality = $this->obj->getImageCompressionQuality() * $quality / 100;\n            $this->obj->setImageCompressionQuality($quality);\n            $this->obj->stripImage();\n\n            if($this->obj->writeImage($dest_img))\n            {\n                $this->destory();\n                return $dest_img;\n            }\n            return false;\n        }\n        catch (ImagickException $e)\n        {\n            return false;\n        }\n    }\n    /*\n\t * ÁîüÊàêÁº©Áï•Âõæ\n\t *\n\t * @param string src_img Ê∫êÂõæÁâáË∑ØÂæÑ\n\t * @param int quality ËÆæÁΩÆÂõæÁâáÂéãÁº©Ë¥®Èáè\n\t * @param string dest_img Ë¶ÅÁîüÊàêÁöÑÂõæÁâáÁöÑË∑ØÂæÑ\n\t * @return boolean ËΩ¨Êç¢ÊàêÂÖ±ËøîÂõûtrue  Âê¶Âàôfalse\n\t */\n    public function thump($src_img,$width = 250,$height = '')\n    {\n        if(!is_object($this->obj))\n        {\n            return false;\n        }\n        try\n        {\n\n            $file_info = pathinfo($src_img);\n            //ÁîüÊàêÁº©Áï•ÂõæÂêçÁß∞\n            $file_name = substr($file_info['basename'],0,strrpos($file_info['basename'],'.'));\n            $dest_img = $file_info['dirname'] . '/' . $file_name . '_thump.' . $file_info['extension'];\n            $this->obj->readImage($src_img);\n            //ËÆ°ÁÆóË¶ÅËé∑ÂæóÁº©Áï•ÂõæÁöÑÈ´òÂ∫¶\n            $img_width = $this->obj->getImageWidth();\n            $img_height = $this->obj->getImageHeight();\n            $dest_height = $img_height * ($width / $img_width);\n            $this->obj->resizeImage($width, $dest_height, Imagick::FILTER_CATROM, 1, false);\n            //ÁîüÊàêÂõæÁâá\n            if($this->obj->writeImage($dest_img))\n            {\n                $this->destory();\n                return $dest_img;\n            }\n            return false;\n        }\n        catch (ImagickException $e)\n        {\n            return false;\n        }\n    }\n    /*\n\t * ÈáäÊîæËµÑÊ∫ê\n\t *\n\t */\n    function destory()\n    {\n        if(is_object($this->obj))\n        {\n            $this->obj->clear();\n\n            $this->obj->destroy();\n        }\n    }\n}\n```\n\n#### PythonÁöÑÁ±ª\n```\n#coding:utf-8\nfrom PIL import Image\nimport os\nfrom Logger import Logger\nimport imghdr\nimport mmap\nfrom PIL import ImageFile\nImageFile.LOAD_TRUNCATED_IMAGES = True\n\n#Ê£ÄÊü•Êñá‰ª∂ÊòØÂê¶Ë¢´ÂéãÁº©Ëøá\ndef checkImageCompressed(savedFilePath,srcFile):\n    f = open(savedFilePath)\n    s = mmap.mmap(f.fileno(), 0, access=mmap.ACCESS_READ)\n    print(srcFile)\n    if s.find(srcFile.encode()) != -1:\n        #print('true')\n        return True\n    else:\n        return False\n\n#Âà§Êñ≠ÂõæÁâáÊ†ºÂºè\ndef checkImageType(srcFile):\n    #print imghdr.what(srcFile)\n    return imghdr.what(srcFile)\n\n\n#Âà§Êñ≠ÊòØÂê¶ÊòØÂõæÁâá\ndef isImage(srcFile):\n    suffix = ['jpg','png']\n    #print \"srcFile: \" + srcFile\n    suffix_srcfile = srcFile.lower().split('.')[2]\n    #print \"suffix_srcfile: \" + suffix_srcfile\n    if suffix_srcfile in suffix:\n        return True\n    else:\n        return False\n\n#ÂõæÁâáÂéãÁº©ÊâπÂ§ÑÁêÜ\ndef compressImage(srcPath,dstPath,dataPath):\n    for filename in os.listdir(srcPath):  \n        #Â¶ÇÊûú‰∏çÂ≠òÂú®ÁõÆÁöÑÁõÆÂΩïÂàôÂàõÂª∫‰∏Ä‰∏™Ôºå‰øùÊåÅÂ±ÇÁ∫ßÁªìÊûÑ\n        if not os.path.exists(dstPath):\n            os.makedirs(dstPath)        \n\n        #ÊãºÊé•ÂÆåÊï¥ÁöÑÊñá‰ª∂ÊàñÊñá‰ª∂Â§πË∑ØÂæÑ\n        srcFile=os.path.join(srcPath,filename)\n        ##print(dstPath,filename)\n        dstFile=os.path.join(dstPath,filename)\n        #print srcFile\n        ##print dstFile\n\n        if os.path.isfile(srcFile):\n            if 'small.' in srcFile:\n                #print \"Â∑≤ÁªèÊòØÂéãÁº©Êñá‰ª∂‰∏çÈúÄË¶ÅÂÜçÂéãÁº©ÔºÅÔºÅ\"\n                logger_ignored.debug(srcFile)\n                continue\n            else:\n                dstFile=os.path.join(dstPath,filename.split('.')[0] + '.' + filename.split('.')[1])\n                #print srcFile\n                #print dstFile       \n        #Â¶ÇÊûúÊòØÊñá‰ª∂Â∞±Â§ÑÁêÜ\n        if os.path.isfile(srcFile):\n            if isImage(srcFile):\n                #Âà§Êñ≠ÊòØÂê¶ÊòØtiffÊ†ºÂºèÔºåËØ•Ê†ºÂºèÊöÇ‰∏çÊîØÊåÅ\n                if checkImageType(srcFile) == 'tiff':\n                    logger_errored.debug(\"-----start the File is tiff, ignore this file.-----\")\n                    logger_errored.debug(srcFile)\n                    logger_errored.debug(\"-----end the File is tiff, ignore this file.-----\")\n                    continue\n\n                #Ê£ÄÊü•ÊòØÂê¶ÂéãÁº©Ëøá\n                if checkImageCompressed(dataPath,srcFile):\n                    logger_ignored.debug(srcFile)\n                    continue\n                try:\n                    #ÊâìÂºÄÂéüÂõæÁâáÁº©Â∞èÂêé‰øùÂ≠òÔºåÂèØ‰ª•Áî®if srcFile.endswith(\".jpg\")ÊàñËÄÖsplitÔºåsplitextÁ≠âÂáΩÊï∞Á≠âÈíàÂØπÁâπÂÆöÊñá‰ª∂ÂéãÁº©\n                    logger_compressed.debug(\"-------start compressed-------\")\n                    logger_compressed.debug(srcFile)\n                    sImg=Image.open(srcFile)  \n                    w,h=sImg.size\n                    logger_compressed.debug(\"src File fomatter: \" + str(w) + \"X\" + str(h) + \"px\")\n                    #print w,h\n                    dImg=sImg.resize((w,h),Image.ANTIALIAS)  #ËÆæÁΩÆÂéãÁº©Â∞∫ÂØ∏ÂíåÈÄâÈ°πÔºåÊ≥®ÊÑèÂ∞∫ÂØ∏Ë¶ÅÁî®Êã¨Âè∑\n                    logger_compressed.debug(\"dest File fomatter: \" + str(w) + \"X\" + str(h) + \"px\")\n                        \n                    #ËΩ¨Êç¢ÊàêRGBÊ®°Âºè\n                    #dImg = dImg.convert('RGB')\n                \n                    \n                    dImg.save(dstFile,\"JPEG\",quality=80) #‰πüÂèØ‰ª•Áî®srcFileÂéüË∑ØÂæÑ‰øùÂ≠ò,ÊàñËÄÖÊõ¥ÊîπÂêéÁºÄ‰øùÂ≠òÔºåsaveËøô‰∏™ÂáΩÊï∞ÂêéÈù¢ÂèØ‰ª•Âä†ÂéãÁº©ÁºñÁ†ÅÈÄâÈ°πJPEG‰πãÁ±ªÁöÑ\n                    #print dstFile+\" compressed succeeded\"\n                    logger_compressed.debug(\"-------end compressed-------\")\n                    logger_compressed.debug(\"-------start saved log-------\")\n                    logger_compressed.debug(srcFile)\n                    logger_saved.debug(srcFile)\n                    logger_compressed.debug(\"-------end saved log-------\")\n                except IOError:\n                    print (\"ÂéãÁº©ÈîôËØØ\")\n                    logger_errored.debug(\"-------start errored-------\")\n                    logger_errored.debug(\"File name: \" + srcFile)\n                    logger_errored.debug(IOError)\n                    logger_errored.debug(\"-------end errored-------\")\n                \n        #Â¶ÇÊûúÊòØÊñá‰ª∂Â§πÂ∞±ÈÄíÂΩí\n        if os.path.isdir(srcFile):\n            compressImage(srcFile,dstFile,dataPath)\n\nif __name__=='__main__':\n    #ËÆ∞ÂΩïÊó•ÂøóÂπ∂‰øùÂ≠òÂà∞Êó•ÂøóÊñá‰ª∂\n    logger_compressed = Logger(logname='log/compressed_debug.log', loglevel=1, logger=\"compressedImage\").getlog()\n    logger_saved = Logger(logname='log/compressed_saved.log', loglevel=5, logger=\"compressSucceededImage\").getlog()\n    logger_ignored = Logger(logname='log/compressed_ignored.log', loglevel=1, logger=\"compressIgnoredImage\").getlog()\n    logger_errored = Logger(logname='log/compressed_error.log', loglevel=1, logger=\"compressErroredImage\").getlog()\n    compressImage(\"./img\",\"./image\",\"data/compressed_saved.log\")\n```\nËÆ∞ÂΩïÊó•ÂøóÁöÑÁ±ª\n```\n# -*- coding: utf-8 -*-\nimport logging\n\n#ÂºÄÂèë‰∏Ä‰∏™Êó•ÂøóÁ≥ªÁªüÔºå Êó¢Ë¶ÅÊääÊó•ÂøóËæìÂá∫Âà∞ÊéßÂà∂Âè∞Ôºå ËøòË¶ÅÂÜôÂÖ•Êó•ÂøóÊñá‰ª∂   \nclass Logger():\n    def __init__(self, logname, loglevel, logger):\n        '''\n           ÊåáÂÆö‰øùÂ≠òÊó•ÂøóÁöÑÊñá‰ª∂Ë∑ØÂæÑÔºåÊó•ÂøóÁ∫ßÂà´Ôºå‰ª•ÂèäË∞ÉÁî®Êñá‰ª∂\n           Â∞ÜÊó•ÂøóÂ≠òÂÖ•Âà∞ÊåáÂÆöÁöÑÊñá‰ª∂‰∏≠\n        '''\n        format_dict = {\n           1 : logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s'),\n           2 : logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s'),\n           3 : logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s'),\n           4 : logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s'),\n           5 : logging.Formatter('%(message)s')\n        }\n        \n\n        # ÂàõÂª∫‰∏Ä‰∏™logger\n        self.logger = logging.getLogger(logger)\n        self.logger.setLevel(logging.DEBUG)\n\n        # ÂàõÂª∫‰∏Ä‰∏™handlerÔºåÁî®‰∫éÂÜôÂÖ•Êó•ÂøóÊñá‰ª∂\n        fh = logging.FileHandler(logname)\n        fh.setLevel(logging.DEBUG)\n\n        # ÂÜçÂàõÂª∫‰∏Ä‰∏™handlerÔºåÁî®‰∫éËæìÂá∫Âà∞ÊéßÂà∂Âè∞\n        ch = logging.StreamHandler()\n        ch.setLevel(logging.DEBUG)\n\n        # ÂÆö‰πâhandlerÁöÑËæìÂá∫Ê†ºÂºè\n        #formatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s')\n        formatter = format_dict[int(loglevel)]\n        fh.setFormatter(formatter)\n        ch.setFormatter(formatter)\n\n        # ÁªôloggerÊ∑ªÂä†handler\n        self.logger.addHandler(fh)\n        self.logger.addHandler(ch)\n\n    \n    def getlog(self):\n        return self.logger\n\n##if __name__=='__main__':  \n##    logger = Logger(logname='log.txt', loglevel=1, logger=\"fox\").getlog()\n##    logger.debug(\"foobar\")    # ‰∏çËæìÂá∫   \n##    logger.info(\"foobar\")        # ËæìÂá∫  \n##    logger.warning(\"foobar\")  # ËæìÂá∫  \n##    logger.error(\"foobar\")      # ËæìÂá∫  \n##    logger.critical(\"foobar\")    # ËæìÂá∫  \n```","tags":["Php","Python"],"categories":["ÈöèÁ¨î"]},{"title":"HexoÂàùÂ≠¶","url":"/tech-notes/hexo-1550644998.html","content":"#### ÁâπÂà´ÊÑüË∞¢\n\nÁ¨¨‰∏ÄÊ¨°‰ΩøÁî®hexoÂª∫Á´ôÔºåÊÑüË∞¢**[hexo](https://hexo.bootcss.com/)ÔºåËôΩÁÑ∂Áúã‰∫ÜÊñáÊ°£ÂØπ‰∏Ä‰∫õÊìç‰ΩúËøòÊòØÂæàËø∑Á≥äÔºÅÊúÄË¶ÅÊÑüË∞¢**[ËØ¥IT](https://shuoit.net)‰ΩúËÄÖ‚Äî‚Äî[ÂîêÂÖàÊ£Æ](https://about.tangkunyin.com)ÔºåÊàëÂÆåÂÖ®ÊääÂîêÂÖàÊ£ÆÁöÑ‰ª£Á†ÅÊê¨‰∫Ü‰∏ãÊù•ÔºåÁÑ∂ÂêéËøõË°å‰∫ÜÁ†îÁ©∂‰øÆÊîπÔºåÊâçÊáÇÂæó‰∫Ü‰∏ÄÁÇπÁÇπË¶ÅÊÄé‰πàÊìç‰ΩúÔºÅüòÇÔºåÂ∏åÊúõÂîêÂÖàÊ£ÆËÄÅÂì•‰∏çË¶Å‰ªãÊÑè„ÄÇ\n\n#### Ë∏©ÁöÑÂùë\n\nÊúÄÂ§ßÁöÑÂùëÔºåÂ∞±ÊòØ **menu** ËøôÂùó‰∫Ü\n\n````\nmenu:\n   ÈöèÁ¨î: tech-notes\n   ‰∫∫Êñá: humanities\n   ÂÖ∂‰ªñ: others\n````\n\n‰øÆÊîπÂêéËÄÅÊòØÊâæ‰∏çÂà∞È°µÈù¢ÔºåÊúÄÂêéÂèëÁé∞Ë¶ÅÂÖàËøêË°åÂ¶Ç‰∏ãÂëΩ‰ª§\n>hexo new post xxx (ÊñáÁ´†ÂêçÁß∞)\n>>ÈªòËÆ§Â∞±ÂèØ‰ª•ËÆøÈóÆ **tech-notes** Ëøô‰∏™ËèúÂçïÔºåÊöÇÊó∂Ëøò‰∏çÁü•ÈÅìÂ¶Ç‰ΩïÁîüÊàêÊñáÁ´†Âà∞ **humanities,others** ‰∏ãÔºåÂ§±Ë¥•ÔºÅüò±\n>> ËÆøÈóÆhumanitiesÔºåÂ∞±ÊääcategoriesÊîπÊàê‰∫∫ÊñáÔºåÁÑ∂ÂêéÂ∞±ÂèØ‰ª•ÊÑâÂø´ÁöÑËÆøÈóÆ‰∫Ü\n\nÂ∑¶ËæπËèúÂçïÁöÑËØùÔºåËøêË°åÂ¶Ç‰∏ãÂëΩ‰ª§\n>hexo new page xxx (Êñ∞È°µÈù¢)\n\n#### Á≤óÊö¥‰øÆÊîπËØÑËÆ∫\n\nÂÆâË£ÖÂêéÂèëÁé∞ËØÑËÆ∫ÊòæÁ§∫‰∏çÂá∫Êù•ÔºåÁΩë‰∏äÊü•ÁúãÂêéÔºåËØ¥ÊòØË¢´Â¢ô‰∫ÜÔºåÁÑ∂ÂêéÁôæÂ∫¶‰∫ÜÊñ∞ÁöÑËØÑËÆ∫Êèí‰ª∂ÔºåÂ∞±ÊòØ**[Valine](https://valine.js.org/)\n1. ÂâçÂæÄ[Leancloud](https://leancloud.cn)ÔºåÊ≥®ÂÜå‰∏Ä‰∏™Ë¥¶Âè∑ÔºåÂàõÂª∫Â∫îÁî®„ÄÇ\n2. ‰∏ªÈ¢òÈÖçÁΩÆÊñá‰ª∂ÈáåÂ¢ûÂä†‰∏ãÈù¢‰ø°ÊÅØ\n````\ncomments:\n  enable: true #\n  appId:  #your leancloud appId\n  appKey: #your leancloud appKey\n  guest_info: nick,mail,link #valine comment header info\n  placeholder: ÂèãÂñÑ‰∫§ÊµÅÔºå‰∏çÂñúÂãøÂñ∑ # valine comment input placeholder(like: Please leave your footprints )\n  avatar: mm # gravatar style https://valine.js.org/avatar\n  pageSize: 10 # comment list page size\n  verify: false # valine verify code (true/false)\n  notify: false # valine mail notify (true/false)\n  lang: zh-cn\n````\n3. Âà∞layout->_partial‰∏ã‰øÆÊîπcomments.ejsÔºå‰øÆÊîπÂ¶Ç‰∏ã\n````\n<% if (theme.comments.enable){ %>\n<section id=\"comments\">\n    <div id=\"valine_thread\" style=\"margin: 30px;\"></div>\n    <script src=\"//cdn1.lncld.net/static/js/3.0.4/av-min.js\"></script>\n    <script src=\"//unpkg.com/valine/dist/Valine.min.js\"></script>\n    <script>\n        var GUEST_INFO = ['nick','mail','link'];\n        var guest_info = '<%= theme.comments.guest_info %>'.split(',').filter(function(item){\n            return GUEST_INFO.indexOf(item) > -1\n        });\n        var notify = '<%= theme.comments.notify %>' == true;\n        var verify = '<%= theme.comments.verify %>' == true;\n        var valine = new Valine();\n        valine.init({\n            el: '#valine_thread',\n            notify: notify,\n            verify: verify,\n            appId: \"<%= theme.comments.appId %>\",\n            appKey: \"<%= theme.comments.appKey %>\",\n            placeholder: \"<%= theme.comments.placeholder %>\",\n            pageSize:'<%= theme.comments.pageSize %>',\n            avatar:'<%= theme.comments.avatar %>',\n            lang:'<%= theme.comments.lang %>'\n        })\n    </script>\n</section>\n<% } %>\n````\n\n#### Âº∫Âà∂‰ΩøÁî®httpsËÆøÈóÆ\n\nËøõÂÖ•git‰ªìÂ∫ìÔºåÁÇπÂáªÊúÄÂè≥ËæπÁöÑSettingsÔºåÂ¶Ç‰∏ãÂõæ\n![Image text](../img/2019/setting-https.png)\n\nÁé∞Âú®ÂèØ‰ª•ÊÑâÂø´ÁöÑËá™ÂÆö‰πâ‰∫ÜÔºåÂÜçÊ¨°ÊÑüË∞¢ [ÂîêÂÖàÊ£Æ](https://about.tangkunyin.com)","tags":["Hexo","ÁΩëÁ´ô"],"categories":["ÈöèÁ¨î"]},{"title":"‰∏∫‰ΩïÂª∫Á´ô && ‰∏∫‰ΩïÂÜô‰Ωú","url":"/about/index.html","content":"\n#### ‰∏∫‰ΩïÂª∫Á´ô\n\nÂª∫Á´ô‰∏ªË¶ÅÊòØ‰∏∫‰∫ÜËÆ∞ÂΩï‰∏Ä‰∫õ‰∏úË•øÔºåÁÑ∂ÂêéÊñπ‰æøÂØªÊâæÔºåÂΩìÁÑ∂‰πüÊòØ‰∏∫‰∫ÜÂíåÂ§ßÂÆ∂‰∫§ÊµÅÔºåÂ≠¶‰π†‰∏Ä‰∫õÊñ∞ÁöÑ‰∏úË•øüòùÔ∏è\nËøòÊúâ‰∏Ä‰∏™ÁõÆÁöÑ‰∏∫‰∫ÜÈù¢ËØïÔºåÂÜô‰∏™ÁÆÄÂéÜÂ•ΩÈ∫ªÁÉ¶ÔºåËøò‰∏çÁü•ÈÅìÂÜôÂï•ÔºåËØ¥ÁöÑÊó∂ÂÄô‰πü‰∏çÁü•ÈÅìËØ¥Âï•ÔºåÂª∫‰∏™Á´ôËÆ∞ÂΩï‰∏ãÔºåÂà∞Êó∂ÂÄô‰∏çÂ∞±ÊÄùÂ¶ÇÊ≥âÊ∂åÔºüÔºàÊúâÁÇπÊÉ≥ÂΩìÁÑ∂Ôºâ\n\n#### ‰∏∫‰ΩïÂÜô‰Ωú\n\nÊï≤‰ª£Á†ÅÔºåÊê¨Á†ñÈÉΩÈ∫ªÊú®‰∫ÜÔºåÈÄÇÂΩìÊîæÊùæ‰∏Ä‰∏ãÔºåÂÜô‰ΩúÂ∞±ÊòØÂæàÂ•ΩÁöÑÊñπÂºè‰∫ÜÔºåÊàëÈÉΩÊÉ≥ËΩ¨Ë°åÂÜôÁΩëÁªúÂ∞èËØ¥ÂéªüòÑ\n\n#### ÂÖ≥‰∫é‰ΩúËÄÖ\n\n> ##### ÂºÄÂ±Ä‰ªãÁªç\n>> ![image text](/img/2019/0042d3a7eeb0f4cc89d34d603bcc5229.jpg)\n>> Ê¢ÅÊü±Êü± Áî∑ Ê±âÊóè ÂÜúÂéÜ1993-03-30Âá∫ÁîüÔºåÂÖ¨ÂéÜ1993-04-21ÔºåÂ§©ËµãÊäÄËÉΩÔºöÊó†ÔºåÊäÄËÉΩÔºöphp js jquery css html mysqlÊåâÂÖ¨ÂéÜÁÆóÊòØÈáëÁâõÂ∫ß!\n>\n>> **Áà±ÊÉÖÊó†ÈúÄË®Ä‰ΩúÂ™íÔºåÂÖ®Âú®ÂøÉÈ¢ÜÁ•û‰ºö„ÄÇ ‚Äî‚Äî Âìà‰ΩõÊ†ºÂ∞î**\n> #### ÂàùÂá∫ËåÖÂ∫ê\n>> ![image text](/img/2019/464a068a06b74657644a616793a757e8.png)\n>> 2010Âπ¥Â∞±ËØª‰∫éÂëºÂíåÊµ©ÁâπËÅå‰∏öÂ≠¶Èô¢Ôºå10Á∫ßÂ∑•ÂïÜ‰ºÅ‰∏öÁÆ°ÁêÜ‰∏ì‰∏öÔºåÂõ†‰∏∫Êú¨‰∫∫‰∏ÄË¥Ø‰ΩéË∞ÉÔºåÊâÄ‰ª•Ê≤°ÂèÇÂä†Ëøá‰ªÄ‰πàÁ§æÂõ¢Âï¶ÁªÑÁªáÂï¶ÁöÑÔºå‰∏ÄÁõ¥‰ΩéË∞ÉÂà∞2013Âπ¥ÊØï‰∏öÔºåÂπ≥Âπ≥Ê∑°Ê∑°Â∞±ÊòØÊàëÁöÑÁúüÂÆûÊòæÁÖßÔºÅÔºÅ!\n>\n>> **ÁîüÊ¥ªÊúâÂ∫¶Ôºå‰∫∫ÁîüÊ∑ªÂØø„ÄÇ ‚Äî‚Äî ‰π¶Êëò**\n> #### Ê±üÊπñËèúÈ∏ü\n>> ![image text](/img/2019/3e04e88bcbb6edd13f99d3f1d880e0d9.jpg)\n>> ÊØï‰∏öÂêéÈÇ£‰∏™Ëø∑Ëå´ÂïäÔºåÂøÉÊãîÂáâÊãîÂáâÊª¥ÔºåÂéªÂåó‰∫¨ÊâæÂ∑•‰ΩúË¢´ÂêÑÁßçÂ•óË∑ØÔºåÂ•Ω‰∏çÂÆπÊòìÊâæ‰∫Ü‰∏™Ê¥ªÂÑøÔºåË£ÖÂç∏Áâ©ÊµÅÔºåÂ¶àËõãÁöÑÔºåÊàëËøôË∫´ÊùøÂÆûÂú®Êâõ‰∏ç‰ΩèÔºå‰∏Ä‰∏™ÊòüÊúüÂêéË∑ëË∑Ø‰∫ÜÔºåÁÑ∂ÂêéÂú®Ë∂ÖÂ∏ÇÂΩì‰øùÂÆâËµö‰∫ÜÂá†‰∏™Ë∑ØË¥πÂõûÂÆ∂‰∫ÜÔºåËØ¥Â§ö‰∫ÜÈÉΩÂøÉÈÖ∏ÔºÅÂõûÂÆ∂ÂêéË∑üÁùÄ‰∏çÁü•ÈÅìÊòØÂèîÂèîËøòÊòØÂ§ßÁà∑Âéª‰∫ÜÂåÖÂ§¥ÔºåËøõ‰∫Ü‰∏™ÂÅöËΩÆÊØÇÁöÑÂéÇÂ≠êÔºåÂπ≤‰∫ÜÂá†‰∏™ÊúàÊª°ÊâãÁöÑÊ∞¥Ê≥°ÂïäÔºåËÄÉËôë‰∫ÜÂ•Ω‰πÖÔºåÊúÄÂêéÂ≠¶‰∫ÜÊï≤‰ª£Á†Å„ÄÇ„ÄÇ„ÄÇÔºåÁÆóÊòØÂàùÊ≠•ËøõÂÖ•Ê±üÊπñÔºåÊàëÊòØÊ±üÊπñËèúÈ∏üÔºÅÔºÅÔºÅ\n>\n>> **‰∏çËææÊàêÂäüË™ì‰∏ç‰ºë„ÄÇ ‚Äî‚Äî ÈôàÊΩ≠Áßã**\n> #### Â∞èËØïÁâõÂàÄ(2014-05)\n>> ![image text](/img/2019/f9cdb61fe985d3ce8835fc504a2f5391.png)\n>> ÊàëÁöÑÁ¨¨‰∏ÄÂÆ∂ÂÖ¨Âè∏Ôºå**ÂåÖÂ§¥Â∏ÇÂä©ÂèãÁßëÊäÄÊúâÈôêÂÖ¨Âè∏**ÔºåËøõÊù•ÁöÑÁ¨¨‰∏Ä‰ªΩÂ∑•‰ΩúÊòØÂÅöÂ§ñÂçñÂπ≥Âè∞ÊâæÁÅ´ÈîÖÔºåÂÅöÂÆåÂêéËÄÅÂ§ßËøò‰∫≤Ëá™Âú®Âπ≥Âè∞‰∏äËÆ¢‰∫ÜÁÅ´ÈîÖ„ÄÇ„ÄÇ„ÄÇÂèØÊÉúËøòÊòØÈªÑ‰∫ÜÔºÅÊé•ÁùÄÂ∞±ÊòØÂõ¥ÁªïÂ§ñÂçñËøôÂùóÂÑøÂÅö‰∫ÜÂêéÂè∞Ë∞ÉÂ∫¶ÔºåÊàëËÆ∞ÂæóÊàëÂΩìÊó∂ÈáçÊñ∞‰øÆÊîπËøôÁöÑ‰ª£Á†Å‰øÆÊîπÁöÑÂ§¥ÁñºÔºåÂΩìÊó∂‰ª£Á†ÅË¥®ÈáèÂ∑ÆÔºåÊäÄÊúØÂûÉÂúæÔºåÊÉ≥ÊÉ≥Â∞±Â§¥Â§ßÔºÅÂÖàÂêéÂèàÂèÇ‰∏é‰∫Ü**ÈôïÁÖ§Ê±ΩËøêÂπ≥Âè∞„ÄÅËÆæÂ§áÁÆ°ÁêÜÁ≥ªÁªü„ÄÅÁâ©‰∏ö‰∫ëÂπ≥Âè∞**\n>\n>> ÈôïÁÖ§Ê±ΩËøêÂπ≥Âè∞ÁöÑÂºÄÂèëÔºåÊàëÊé•Ëß¶‰∫Ü~~`hbuilder`~~Ëøô‰∏™ÂºÄÂèëÂ∑•ÂÖ∑ÔºåÈÄöËøáÂ§ßÈáèÁöÑÂ≠¶‰π†ÔºåÁÜüÊÇâ‰∫Ü~~`mui`~~Âíå~~`h5+`~~,ÁÜüÊÇâ‰∫ÜwebappÁöÑÊâìÂåÖÔºåÂ≠¶‰ºö‰∫ÜÁî®ÂéüÁîüjsÁºñÂÜôappÂ∫îÁî®ÁöÑËÉΩÂäõ\n>> ËÆæÂ§áÁÆ°ÁêÜÁ≥ªÁªüÁöÑÂºÄÂèëÔºåÊàëÊé•Ëß¶‰∫Ü~~`laravel`~~Ê°ÜÊû∂ÔºåÂ≠¶‰ºö‰∫ÜÊú¨Âú∞ÈÉ®ÁΩ≤Ôºå‰ΩøÁî®~~`composer`~~ÁÆ°ÁêÜËøêÁî®Á¨¨‰∏âÊñπÊèí‰ª∂\n>> Áâ©‰∏ö‰∫ëÂπ≥Âè∞ÔºåÁ¨¨‰∏ÄÊ¨°ÊàêÂäüÈÉ®ÁΩ≤‰∫Ü~~`iis`~~ÊúçÂä°Âô®\n>\n>> **‰∏çËææÊàêÂäüË™ì‰∏ç‰ºë„ÄÇ ‚Äî‚Äî ÈôàÊΩ≠Áßã**\n> #### Ê≠•Â±•Áª¥Ëâ∞(2018-04)\n>> ![image text](/img/2019/f903800947803e93bf9852395dbda4a7.jpg)\n>> 2018Âπ¥4Êúà‰ªΩÊù•Âà∞Â§ß‰∏äÊµ∑Ôºå‰∏ç‰ºöÈù¢ËØïÔºåÂ§ÑÂ§ÑÁ¢∞Â£ÅÔºåÊúÄÁªàÊâæÂà∞‰∏™ÂÖ¨Âè∏**ËâæËá¥ÁßëÊäÄ**ÔºåÂÖ¨Âè∏‰∏äÁè≠Ëá™Áî±Ôºå‰∏çÁü•ÈÅìË¶Å‰∏çË¶ÅÁªßÁª≠Èù¢ËØïÔºåÊÄïÊÄïÊÄï~ ÂÆåÊàêÁöÑÈ°πÁõÆÔºö**ÊòìÊù∞Á¶èÂà©Âπ≥Âè∞ÔºåÊòìÊù∞Á¶èÂà©ÂêéÂè∞ÔºåÁÇ´ÂΩ©Ëâ≤Âç°ÔºåÂçñÂú∫Â§ßËΩ¨ÁõòÂêéÂè∞**,ÁõÆÂâç‰∏ÄÁõ¥Âú®ÂÅöÊï∞ÊçÆÁª¥Êä§ÂíåÁªüËÆ°\n>\n>> **ÊòìÊù∞Á¶èÂà©ÂêéÂè∞**  ![image text](/img/2019/welfareplus_admin.png)\n>> **ÊòìÊù∞Á¶èÂà©Âπ≥Âè∞**  ![image text](/img/2019/welfareplus1.png)  ![image text](/img/2019/welfareplus2.png)\n>> Â§ßÈÉ®ÂàÜÂäüËÉΩÈÉΩÊòØÊàëËá™Â∑±ÂÆåÊàê\n>> **ÁÇ´ÂΩ©Ëâ≤Âç°**  ![image text](/img/2019/xuancai.png)\n>> ÂåÖÊã¨Êê≠Âª∫ÔºåÊï∞ÊçÆÂ∫ìËÆæËÆ°ÔºåÊï¥Á´ôÈÉΩÊòØÁã¨Á´ãÂÆåÊàê\n>> **ÂçñÂú∫Â§ßËΩ¨ÁõòÂêéÂè∞**  ![image text](/img/2019/mc.png)\n>> Êï¥Á´ôÈÉΩÊòØÁã¨Á´ãÂÆåÊàê\n>\n>> **ËøáÊîæËç°‰∏çÁæÅÁöÑÁîüÊ¥ªÔºåÂÆπÊòìÂæóÂÉèÈ°∫Ê∞¥Êé®ËàüÔºå‰ΩÜÊòØË¶ÅÁªìËØÜËâØÊúãÁõäÂèãÔºåÂç¥ÈöæÂ¶ÇÁôªÂ§©„ÄÇ ‚Äî‚Äî Â∑¥Â∞îÊâéÂÖã**\n>\n> #### Êï∞ÊçÆÁªüËÆ°(2019-02)\n>>  ![image text](/img/2019/2019.png)\n>> ÊàëËÆ®ÂéåÊï∞ÊçÆÁªüËÆ°ÔºåÂ§™Ë¥πËÑëÂ≠êÔºåËøòÂÅö‰∏çÂ•ΩÔºÅÊ±ÇÊç¢Ê¥ª„ÄÇ„ÄÇ„ÄÇ\n>\n>>  **ÊúÄÂõ∞ÈöæÁöÑ‰∫ãÊÉÖÂ∞±ÊòØËÆ§ËØÜËá™Â∑±„ÄÇ‚Äî‚ÄîÂ∏åËÖä**\n"},{"title":"ÊàëÁöÑÊó•Âøó","url":"/book/index.html","content":"> 2019-02-21\n>> Á†îÁ©∂ÂõæÁâáÂéãÁº©ÔºåÂπ∂Â∫îÁî® \n>\n> 2019-02-22\n>> ‰ºòÂåñÂ∑¶Èù¢ËèúÂçï‰∏çÈÄâ‰∏≠ÁöÑÈóÆÈ¢òÔºåËøô‰∏™ÈóÆÈ¢òÊòØÂõ†‰∏∫ÈìæÊé•ÂêéÈù¢Ëá™Âä®Ê∑ªÂä†‰∫ÜÊñúÊù†ÔºåÊâæÂà∞leftMenu.ejsÂä†‰∏äÂç≥ÂèØ\n> \n>> cha168Ê∑ªÂä†Ëá™Âä®Âåñ‰∏ä‰∏ãÊû∂ËÑöÊú¨ÔºågiftË°®ÈáåÊñ∞Â¢ûÂ≠óÊÆµtstatus,tinfoÔºåÁî®Êù•Ê£ÄÊµãÂå∫ÂüüÁ§ºÂìÅ\n>\n> 2019-02-23\n>> Êê¨ÂÆ∂ÔºåÊê¨ÂÆ∂ÔºåÊê¨ÂÆ∂ üò•\n>\n> 2019-02-24\n>> Âë®Êú´‰ºëÊÅØüòú\n>\n> 2019-02-25\n>> ‰øÆÊîπËøõÈÄÄË¥ßÁõëÊéßÂØºÂá∫\n>\n>> ‰øÆÊîπ‰∫¨‰∏úÊé®ÈÄÅÊé•Âè£Êï∞ÊçÆËé∑Âèñ\n>\n> 2019-02-26\n>> Êé•Âè£ËßÑÂàôÂèòÂåñÔºåÁ≠âÂæÖË∞ÉÊï¥ÔºåÊöÇÊó∂Êîπ‰∏∫ÊâãÂä®‰øÆÊîπ\n>\n> 2019-02-27\n>> ‰øÆÊîπÂçöÂÆ¢ËØÑËÆ∫Êèí‰ª∂Ôºå‰ΩøÁî®‰∫Ügitalk\n>\n>> Êñ∞Â¢ûËèúÂçï„ÄêÂçïÊõ≤„ÄëÔºåhexo-tag-aplayerÔºåÂºïÂÖ•ËôæÁ±≥Èü≥‰πê\n>\n> 2019-02-28\n>> ÈááÈõÜÂ•ΩÁúãÁü≠ËßÜÈ¢ëÔºåÈááÈõÜ‰∏ãÊù•ÁöÑÈìæÊé•ÔºåÈúÄË¶ÅÂú®È°µÈù¢headÈáåÊ∑ªÂä†`<meta name=\"referrer\" content=\"never\">`\n>> ÊöÇÊó∂‰∏çÁü•ÈÅìÂä†‰∏äÊúâ‰ªÄ‰πàÂùèÂ§ÑÔºåÂèçÊ≠£ËÉΩÊí≠Êîæ‰∫Üüò≠\n>\n> 2019-03-01\n>> ‰øÆÊîπkindeditorÁºñËæëÂô®‰∏∫ueditorÁºñËæëÂô®\n>\n> 2019-03-04\n>> Á†îÁ©∂Êï∞ÊçÆÁªüËÆ°Ôºå‰∏Ä‰∏™ËØ≠Âè•ËµÑÊ∫êÂç†Áî®Â§™Â§ßÔºåÊúçÂä°Âô®Â¥©‰∫ÜÔºÅËÄÉËôëÊääÊï∞ÊçÆÁªüËÆ°ÁßªÂà∞Âè¶‰∏Ä‰∏™ÊúçÂä°Âô®üò±\n>\n> 2019-03-07\n>> Áî∑ÊóèÈ°πÁõÆÔºåÂ¢ûÂä†ÊùÉÈôêÁÆ°ÁêÜÁõ∏ÂÖ≥\n>\n> 2019-03-09\n>> ‰ªäÂ§©ÊàëÊãå‰∫Ü‰∏™ÂáâËèúÔºåÂúüË±Ü‰∏ùÔºåËÉ°ËêùÂçú‰∏ùÔºåÁôΩËêùÂçú‰∏ùÔºåÂàáÁöÑÊàëÊâãÈ∫ªÔºÅÔºÅÔºÅ\n>\n> 2019-03-11\n>> Áªà‰∫éÊääÁî∑ÊóèÈ°πÁõÆÁöÑÊùÉÈôêË∞ÉÊï¥Â•Ω‰∫Üüò•\n>\n> 2019-03-13\n>> Âà©Áî®ÂºÄÊîæÁ§æÂå∫ÁöÑpython SDKÈááÈõÜËÇ°Á•®Êï∞ÊçÆ\n>\n> 2019-03-14\n>> Ë∞ÉËØïËÑöÊú¨\n>\n> 2019-03-17\n>> ÁºñÂÜôËÇ°Á•®ÈááÈõÜÊï¥‰ΩìÊû∂ÊûÑ\n>\n> 2019-04-04\n>> ‰ªäÂ§©ÈÅáÂà∞‰∏™ÂÜÖÂ≠òÊ∫¢Âá∫ÁöÑÂùëÔºåËøêË°åsqlËØ≠Âè•‰∏Ä‰ºöÂÑøÊ≠£Â∏∏‰∏Ä‰ºöÂÑøÁ©∫ÁôΩÔºåÊêûÂçäÂ§©ÊâçÂèëÁé∞ÊòØÂÜÖÂ≠òÊ∫¢Âá∫ÔºÅüò≠"},{"title":"Ê†áÁ≠æ‰∫ë","url":"/tags/index.html","content":"\n\n"}]