<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Hexo 3.8.0"><title>音乐播放</title><meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta charset="UTF-8"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="full-screen" content="yes"><meta name="browsermode" content="application"><meta name="x5-fullscreen" content="true"><meta name="x5-page-mode" content="app"><link rel="stylesheet" media="screen" href="./bootstrap/css/bootstrap.min.css"><link rel="stylesheet" media="screen" href="./font-awesome/css/font-awesome.min.css"><link rel="stylesheet" media="screen" href="./css/APlayer.min.css?v={$site.version}"></head><body><form class="form-inline" role="form"><div class="input-group pull-right"><i class="btn btn-defautl fa fa-minus" onclick='clearInterval(rem.tt),parent.document.getElementById("musicframe").height="25px"'></i><i class="btn btn-defautl fa fa-window-maximize" onclick="rem.tt=setInterval(refresh,100)"></i><i class="btn btn-defautl fa fa-window-close" onclick='parent.document.getElementById("musicframe").remove()'></i></div><div style="clear:both"></div><div class="input-group"><span class="input-group-btn" style="width:100px"><select class="form-control" name="source"><option value="netease">网易云</option><option value="tencent">QQ音乐</option><option value="xiami">虾米</option><option value="kugou">酷狗</option><option value="baidu">百度</option></select></span><input type="text" class="form-control" name="name" placeholder="搜索歌手，歌名，专辑"> <span class="input-group-btn"><button id="music_search" class="btn btn-primary" type="button">搜索</button></span></div></form><div id="aplayer"></div><script src="./js/SimpleCore.js"></script><script src="./js/APlayer.min.js"></script><script>var rem=[];
    var config = {
        url: "https://api.i-meto.com/meting/api",
        container:document.getElementById('aplayer'),
        fixed: !1,
        mini: !1,
        autoplay: !1,
        theme: '#FADFA3',
        loop: 'all',
        order: 'list',
        preload: 'none',
        volume: 0.7,
        mutex: !0,
        listFolded: !0,
        listMaxHeight: '240px',
        lrcType: 2,
        storageName: 'aplayer'
    };

    const ap = new APlayer(config);
    var musicList = ap.storage.get('musicList')||null;
    if(musicList){
        ap.list.add(musicList);
        ap.list.switch(ap.storage.get('index'));
        //ap.play();
    }else{
        //ajaxApi('787436550','playlist','xiami');
        ajaxApi('778066540','playlist','xiami');
    }
    function ajaxApi(id,types,source) {
        $.ajax({
            url: config.url,
            type: 'GET',
            data: {
                id:id,
                type:types,
                server:source
            },
            dataType: 'json',
            success:function (data) {
                ap.list.clear();
                ap.list.add(data);
                ap.storage.set('musicList',data)
            },
            error: function(XMLHttpRequest, textStatus, errorThrown) {
                console.error(XMLHttpRequest + textStatus + errorThrown);
            }
        })
    }
    $('#music_search').on('click',function () {
        var source = $('select[name="source"]').val();
        var name = $('input[name="name"]').val();
        if(!name) return;
        ajaxApi(name,'search',source)
    });
    ap.on('play',function () {
        ap.storage.set('index',ap.list.index);
        var msg = ap.list.audios[ap.list.index].name+'-'+ap.list.audios[ap.list.index].artist;
        // 清除定时器
        if (rem.titflash !== undefined )
        {
            clearInterval(rem.titflash);
        }
        // 标题滚动
        titleFlash(msg);
    });
    var flag=0;
    ap.on('playing',function () {
        if(!flag){
            ap.seek(ap.storage.get('currentTime'));
        }
        flag=1;
    });
    // 标题滚动
    function titleFlash(msg) {

        // 截取字符
        var tit = function() {
            msg = msg.substring(1,msg.length)+ msg.substring(0,1);
            parent.document.title = msg;
        };
        // 设置定时间 300ms滚动
        rem.titflash = setInterval(function(){tit()}, 500);
    }
    //刷新页面时记录播放时间
    window.onbeforeunload = function () {
        ap.storage.set('currentTime',ap.audio.currentTime);
    };
    //自框架自适应
    function refresh(){
        var iframe2 = parent.document.getElementById("musicframe");
        var bHeight = iframe2.contentWindow.document.body.scrollHeight;
        iframe2.height = bHeight;
        //rem.tt = setInterval(refresh,100);
    }
    window.onload = function(){
        rem.tt = setInterval(refresh,100);
    };</script></body></html>